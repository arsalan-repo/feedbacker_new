var srv=function(){var show_log=!1,user_touching=!1,isIE=document.documentMode&&(8==document.documentMode||9==document.documentMode),eventsHandlers={form_loaded:[]},touch_css={"-ms-touch-action":"manipulation","touch-action":"manipulation"},isPreview=-1<document.location.pathname.indexOf("/survey/manage/preview/"),PUBLIC_LANDING=-1<document.location.pathname.indexOf("/survey/public/take-survey/"),LOCATION_REF=PUBLIC_LANDING?document.location.href+(document.querySelector("#public-survey-page-querystring")&&document.querySelector("#public-survey-page-querystring").value):document.location.href,ALL_KEYS=[],FROM_DOMAIN="",FIRST_INIT=!0,PM_INIT=!1;function base(){return{current_block:"",resize_int:0,modalFirst:!0,modal_open:!1,modal_dismissed:!1,followUpId:!1,sendMode:"insert",hide_on_init:[],lock_submit:!1,required_when_visible:[],version:"1.3",domain:"mopinion",div_name:"surveyContent",remote:!0,outer_modal:"",prev_page:"",next_page:"",current_page:1,page_count:1,page_history:{},rules_set:[],show_progress:!1,window_viewport:"",document_title:"",form_completion_ratio:0,trigger_method:"passive",is_loading:!0,show_button:!1,cookie_expire:365,slider:{},button:{},ga_id:"",error_messages:{deflt:"Something went wrong",required:"This field is required",required_multi:"All fields are required",invalid_number:"This is not a valid number",invalid_phone:"This is not a valid phone number",invalid_email:"This is not a valid email address",too_short:"The answer is too short",too_long:"The answer is too long"}}}function opener(e){var r,t,a=(e=e||{}).key;if(void 0===a)return srv.log("Formkey required",!0,"warn"),!1;if(srv.hasOwnProperty(a)){r=a,(t=function(){setTimeout(function(){srv[r].is_loading?t():(srv[r]=__MS.extend({},srv[r],e),"proactive"===srv[r].trigger_method||"exit"===srv[r].trigger_method||"force"===srv[r].trigger_method||"preview"===srv[r].trigger_method?"slide"==srv[r].slider.type?srv.preloadSlider(r,"open"):srv.openModal(!0,r):"passive"===srv[r].trigger_method&&void 0===srv[r].survey_properties&&srv.showButton(r))},50)})()}else srv.hasOwnProperty(a)||srv.loadSurvey(e,function(){srv.open(e)})}function loadSurvey(e,r){if("true"==getCookie("Mopinion_Debug")&&(this.show_log=!0),!srv.hasOwnProperty(e.key)||srv[e.key].is_loading){if("object"!=typeof e)return srv.log("Form key required",!0,"warn"),!1;FROM_DOMAIN?e.domain=FROM_DOMAIN:FROM_DOMAIN=e.domain;var t=e.key;if(-1==ALL_KEYS.indexOf(t)&&ALL_KEYS.push(t),void 0===e.testMode&&(e.testMode=!1),this[t]=__MS.extend({},base(),e),this[t].url="https://"+this[t].domain+"/survey/public/stream?key="+t+"&domain="+this[t].domain,void 0!==e.modal?(this[t].outer_modal=e.modal,this[t].url+="&modal="+this[t].outer_modal):this[t].outer_modal=!0,this[t].url+="&version="+this[t].version,!this[t].div_name)return srv.log("Output div is not set",!0,"warn"),!1;if(srv.log("Loading Mopinion Feedback Form with key "+t,!1,"info"),FIRST_INIT)this.loadjQuery(t),FIRST_INIT=!1;else{var a=this,s=function(){"function"==typeof srv.jQuery?a.loadJSON(t,r):setTimeout(s,50)};s()}}else"function"==typeof r&&r()}function loadjQuery(e,r){var t=this,a="https://"+this[e].domain+"/assets/js/jquery-2.2.4.min.js",s=function(){return void 0!==window.jQuery?"jQuery":void 0!==window.$&&window.$.fn&&window.$.fn.jquery?"$":void 0},o=s();o?!function(e){var r=e.split(".");if(1<r.length){if(1==Number(r[0])){if(10<=Number(r[1]))return!0}else if(2<=Number(r[0]))return!0;return!1}return!1}(window[s()].fn.jquery)?srv.appendScript(a,"SRVQUERY",!1,!1,function(){t.loadjQueryHandler(!0,e,r)}):(t.jQuery=window[o],t.loadHelpers(e),t.loadJSON(e,r)):srv.appendScript(a,"SRVQUERY",!1,!1,function(){t.loadjQueryHandler(!1,e,r)})}function loadjQueryHandler(e,r,t){e?srv.jQuery=window.jQuery.noConflict(!0):(jQuery=window.jQuery.noConflict(!0),srv.jQuery=jQuery),this.loadHelpers(r),this.loadJSON(r,t)}function loadHelpers(e){var r="https://"+srv[e].domain;if(isIE){var t=r+"/assets/surveys/"+srv[e].version+"/js/jquery.xdomainrequest.min.js";this.appendScript(t,"#XDOMAINHELPER#",!1,"jQuery")}document.documentMode<9&&(srv.appendScript(r+"/assets/js/selectivzr.min.js","selectivzr"),srv.appendScript(r+"/assets/js/html5shiv.min.js","html5shiv"),srv.appendScript(r+"/assets/js/respond.min.js","respond"),srv.appendStyle(r+"/assets/css/surveys/survey-IE8.css","ie8style"))}function loadJSON(e,r){r="function"==typeof r&&r,this.appendScript(srv[e].url,"SRVvars"+e,!1,!1,r)}function generateHTML(e,a){var r=!1,t=current_block.properties,s=t.elements||!1,o=t.required,n="req",i=t.format?t.format:"",l=t.placeholder?t.placeholder:"",d=current_block.id,c=t.value,u=srv.jQuery("<span>").addClass("required-mark").html("*"),v="section_break"===e?"h3":"legend",p="section_break"===e?"section-title":"block-title";if(current_block.tooltip){r=srv.jQuery("<a>").addClass("tooltip").attr("href","#").css(touch_css).html(' <i class="fa fa-question"></i> <span>'+current_block.tooltip+"</span>");p+=" has-tooltip"}var f=srv.jQuery("<"+v+">").addClass(p).html(current_block.title).append(r);if(o&&f.append(u),$block=srv.jQuery("<div>").attr("id",d).addClass("control-group question").append(f),"input"===e)X=srv.jQuery("<input>").attr("id",e+"_"+d).attr("type","text").addClass(i).prop("placeholder",l).css(touch_css).val(c),o&&X.addClass(n),iOSTest("fixed_positioning")&&X.on("focus",function(e){srv[a].outer_modal||srv.callParentWindow({fn:'(function(){ srv.jQuery("[data-key='+a+']").closest(".surveyWindowWrap").css({top:srv.jQuery(document).scrollTop(),bottom:"auto"}) })'})}).on("blur",function(e){srv[a].outer_modal||srv.callParentWindow({fn:'(function(){ srv.jQuery("[data-key='+a+']").closest(".surveyWindowWrap").css({position:"fixed",top:0,bottom:0}); setTimeout(function() { srv.resizeForm({update:true}); },100); })'})}),iOSTest("scroll_on_input")&&X.on("focus",function(e){if(!srv[a].outer_modal){var r="slide"==srv[a].slider.type?'srv.jQuery("[data-key='+a+']").closest(".surveySliderScroller")':'srv.jQuery("[data-key='+a+']").closest(".surveyWindowWrap")';setTimeout(function(){srv.callParentWindow({fn:"(function() { srv.scrollPos = "+r+'.scrollTop(); srv.jQuery(window).on("scroll.fix_scroll", function() { srv.scrollTop = '+r+".scrollTop() }); })"})})}}).on("input",function(e){if(!srv[a].outer_modal){var r="slide"==srv[a].slider.type?'srv.jQuery("[data-key='+a+']").closest(".surveySliderScroller")':'srv.jQuery("[data-key='+a+']").closest(".surveyWindowWrap")';srv.callParentWindow({fn:"(function() { "+r+".scrollTop(srv.scrollPos) })"})}}).on("blur",function(){srv[a].outer_modal||srv.callParentWindow({fn:'(function() { srv.jQuery(window).off("scroll.fix_scroll") })'})}),$block.append(X);else if("textarea"===e)X=srv.jQuery("<textarea>").attr("id",e+"_"+d).addClass(i).prop("placeholder",l).css(touch_css).html(c),iOSTest("fixed_positioning")&&X.on("focus",function(e){srv[a].outer_modal||srv.callParentWindow({fn:'(function(){ srv.jQuery("[data-key='+a+']").closest(".surveyWindowWrap").css({top:srv.jQuery(document).scrollTop(),bottom:"auto"}) })'})}).on("blur",function(e){srv[a].outer_modal||srv.callParentWindow({fn:'(function(){ srv.jQuery("[data-key='+a+']").closest(".surveyWindowWrap").css({position:"fixed",top:0,bottom:0}); setTimeout(function() { srv.resizeForm({update:true}); },100); })'})}),iOSTest("scroll_on_input")&&X.on("focus",function(e){if(!srv[a].outer_modal){var r="slide"==srv[a].slider.type?'srv.jQuery("[data-key='+a+']").closest(".surveySliderScroller")':'srv.jQuery("[data-key='+a+']").closest(".surveyWindowWrap")';setTimeout(function(){srv.callParentWindow({fn:"(function() { srv.scrollPos = "+r+'.scrollTop(); srv.jQuery(window).on("scroll.fix_scroll", function() { srv.scrollTop = '+r+".scrollTop() }); })"})})}}).on("input",function(e){if(!srv[a].outer_modal){var r="slide"==srv[a].slider.type?'srv.jQuery("[data-key='+a+']").closest(".surveySliderScroller")':'srv.jQuery("[data-key='+a+']").closest(".surveyWindowWrap")';srv.callParentWindow({fn:"(function() { "+r+".scrollTop(srv.scrollPos) })"})}}).on("blur",function(){srv[a].outer_modal||srv.callParentWindow({fn:'(function() { srv.jQuery(window).off("scroll.fix_scroll") })'})}),o&&X.addClass(n),$block.append(X);else if("select"===e){for(var y in X=srv.jQuery("<select>").attr("id",e+"_"+d),o&&X.addClass(n),""!=l&&(X.attr("data-placeholder","true"),$placeholder=srv.jQuery("<option>").addClass("option_placeholder").attr({id:"option_"+d+"_0",disabled:!0}).prop("selected",!0).val("").css(touch_css).html(l),X.append($placeholder)),s){"function"!=typeof(k=s[y])&&(Pe=srv.jQuery("<option>").attr("id","option_"+d+"_"+y).val(k.label).css(touch_css).html(k.label),t.selected==y&&Pe.prop("selected",!0),X.append(Pe))}(_=void 0!==t.setScoreCookie&&t.setScoreCookie)&&X.on("change",function(){var e=X.parents(".control-group").attr("id");srv[a].outer_modal?srv.setCookie("MSanswer."+a+"."+e,X.find("option:selected").val(),0,"/",void 0,!1):srv.callParentWindow({fn:"srv.setCookie('MSanswer."+a+"."+e+"','"+X.find("option:selected").val()+"',0,'/',undefined,false )"})}),$block.append(X)}else if(-1<["checkbox","radio","category","gcr"].indexOf(e)){var m="radio"===e?"rdo_":"chk_",h="category"===e||"gcr"===e?"radio":e,_=void 0!==t.setScoreCookie&&t.setScoreCookie;if("gcr"==e)var g=!!t.reverseScore&&t.reverseScore;else g=!1;var b={},j=!1;for(var y in X=srv.jQuery("<div>"),s){var k=s[y],Q=!1,w=d+"_"+y;if("function"!=typeof k){if(k.icon)Q=srv.jQuery("<i>").addClass(k.icon);var C=k.value||k.label,S=srv.jQuery("<input>").attr("type",h).attr("id",e+"_"+w).attr("name",e+"Group_"+d).on("click",function(){srv.setValue(this,e+"_"+d,"radio"!==h)}).css(touch_css).val(C);isActive(y,current_block)&&(S.prop("checked","checked"),b[m+y]=k.label,0,j=!0);var x=srv.jQuery("<label>").attr("id","label_"+w).attr("for",e+"_"+w).addClass(e+" inline").append(Q).css(touch_css).append(" "+k.label),T=srv.jQuery("<div>").addClass(e+"-wrapper").append(S).append(x);1==t.show_as_buttons&&(T.addClass("button"),X.addClass("button-container")),X.append(T)}}var M=j?JSON.stringify(b):"";I=srv.jQuery("<input>").attr("type","hidden").attr("id",e+"_"+d).on("blur",function(){showError(srv.jQuery(this),__MS.validateField(this))}).val(M),o&&I.addClass(n),_&&I.on("change",function(){var e=I.parents(".control-group").attr("id");srv[a].outer_modal?srv.setCookie("MSanswer."+a+"."+e,I.val(),0,"/",void 0,!1):srv.callParentWindow({fn:"srv.setCookie('MSanswer."+a+"."+e+"','"+I.val()+"',0,'/',undefined,false )"})}),$block.addClass("clearfix").append(X).append(I).append('<p class="clearfix"></p>'),"gcr"==e&&g&&setTimeout(function(){var e=jQuery("#gcr_"+d+"_1").parent(),r=jQuery("#gcr_"+d+"_2").parent(),t=jQuery("#gcr_"+d+"_3").parent();r.insertBefore(e),t.insertBefore(r)})}else if("thumbs"===e){X=srv.jQuery("<div>").addClass("button-container thumbs-container");var E="",P="";for(var y in s){var $=getPreselectValue("thumbs",a);(Z=t.preselectScore&&$&&$==s[y].value)&&(E=s[y].value,P=d);var N=srv.jQuery("<div>").addClass("thumbs-wrapper button"),O=srv.jQuery("<input>").attr("type","radio").attr("id","thumbs_"+d+"_"+y).attr("name","thumbsGroup_"+d).attr("value",s[y].value).on("click",function(){srv.setValue(this,e+"_"+d)}).prop("checked",Z),W=srv.jQuery("<label>").addClass("label_thumbs_"+s[y].value).attr("id","label_thumbs_"+d+"_"+y).attr("for","thumbs_"+d+"_"+y).css(touch_css).html('<i class="fa '+s[y].icon+'" aria-hidden="true"></i>');s[y].label&&t.labelsAsValue&&W.append('<span class="thumbs_lbl_'+y+'">'+s[y].label+"</span>"),N.append(O,W),X.append(N)}if(I=srv.jQuery("<input>").attr("type","hidden").attr("id",e+"_"+d).on("blur",function(){showError(srv.jQuery(this),__MS.validateField(this))}),(_=void 0!==t.setScoreCookie&&t.setScoreCookie)&&I.on("change",function(){var e=I.parents(".control-group").attr("id");srv[a].outer_modal?srv.setCookie("MSanswer."+a+"."+e,I.val(),0,"/",void 0,!1):srv.callParentWindow({fn:"srv.setCookie('MSanswer."+a+"."+e+"','"+I.val()+"',0,'/',undefined,false )"})}),""!==E){I.val(E);var L=!!sessionStorage.getItem("emailscore");srv.jQuery(document).one("mopinion_ready",function(e){e.detail.key===a&&setTimeout(function(){jQuery("#thumbs_"+P).trigger("change"),L||(srv.send(!1,a),sessionStorage.setItem("emailscore",!0))},500)})}o&&I.addClass(n),$block.append(X).append(I)}else if("rating"===e){var A=srv.jQuery("<div>").addClass("choice-row"),I=srv.jQuery("<input>").attr("type","hidden").attr("id","rating_"+d);(_=void 0!==t.setScoreCookie&&t.setScoreCookie)&&I.on("change",function(){var e=I.parents(".control-group").attr("id");srv[a].outer_modal?setCookie("MSanswer."+a+"."+e,I.val(),"session","/",void 0,!1):srv.callParentWindow({fn:"srv.setCookie('MSanswer."+a+"."+e+"','"+I.val()+"','session','/',undefined,false )"})});E="",P="";if(o&&I.addClass(n),"numeric"==t.type){var F=t.includeZero?0:1;for(M=t.checked&&"number"==typeof t.checked[0]?t.checked[0]:"",y=F;y<parseInt(t.scale)+1;y++){$=getPreselectValue("score",a);(Z=t.preselectScore&&$&&$==y)&&(E=y,P=d);w=d+"_"+y;var B=srv.jQuery("<input>").attr("type","radio").attr("id","rating_"+w).attr("name","radioGroup_"+d).prop("checked",Z).on("click",function(){srv.setValue(this,e+"_"+d)}).css(touch_css).val(y);t.checked&&t.checked[0]==y&&B.prop("checked",!0);var q=srv.jQuery("<label>").attr("id","label_"+w).attr("for","rating_"+w).css(touch_css).html(y),R=srv.jQuery("<div>").addClass("rating-choice").append(B).append(q);A.append(R)}X=srv.jQuery("<div>").addClass("rating-group numeric").append('<span class="rating-prefix"></span>').append(A).append('<span class="rating-suffix"></span>')}else if("bar"==t.type){for(M="",y=1;y<6;y++){if(1==y)var H="--";else if(2==y)H="-";else if(3==y)H="0";else if(4==y)H="+";else if(5==y)H="++";w=d+"_"+y,B=srv.jQuery("<input>").attr("type","radio").attr("id","rating_"+w).attr("name","radioGroup_"+d).on("click",function(){srv.setValue(this,e+"_"+d)}).css(touch_css).val(y),q=srv.jQuery("<label>").attr("id","label_"+w).attr("for","rating_"+w).css(touch_css).html("<span>"+H+"</span>"),R=srv.jQuery("<div>").addClass("rating-choice").append(B).append(q);A.append(R)}X=srv.jQuery("<div>").addClass("rating-group bar").append('<span class="rating-prefix"></span>').append(A).append('<span class="rating-suffix"></span>')}else if("emoji"==t.type){for(var V=["angry","sad","neutral","happy","extra-happy"],D=($=getPreselectValue("smiley",a),0);D<V.length;D++){y=Number(D)+1;(Z=t.preselectScore&&$&&$==y)&&(E=y,P=d);w=d+"_"+y,B=srv.jQuery("<input>").attr("type","radio").attr("id","rating_"+w).prop("checked",Z).attr("name","radioGroup_"+d).on("click",function(){srv.setValue(this,e+"_"+d)}).css(touch_css);t.labelsAsValue?B.val(t.emoji[y].label):B.val(y);q=srv.jQuery("<label>").attr("id","label_"+w).attr("for","rating_"+w).css(touch_css);if(t.showCaptions&&q.attr("data-label",t.emoji[y].label),supportsSvg())!function(r,t){srv.jQuery.ajax({url:"https://"+srv[a].domain+"/assets/img/surveys/emoji/"+t+".svg",type:"get",dataType:"text"}).done(function(e){r.addClass("emoji-"+t).html(e)})}(q,V[D]);else srv[a].jQuery("<img>").attr({src:"https://"+srv[a].domain+"/assets/img/surveys/emoji/"+V[D]+".png",height:"100%",width:"100%"}).appendTo(q);R=srv.jQuery("<div>").addClass("rating-choice").append(B).append(q);A.append(R)}X=srv.jQuery("<div>").addClass("rating-group emoji").append('<span class="rating-prefix"></span>').append(A).append('<span class="rating-suffix"></span>'),t.showCaptions&&X.addClass("show-labels")}else{var z=t.checked;M="";$=getPreselectValue("score",a);for(var y in s){if("function"!=typeof(k=s[y])){var U=t.labelsAsValue&&""!==k.label?k.label:y;(Z=t.preselectScore&&$&&$==y)&&(E=y,P=d);R=srv.jQuery("<input>").attr("type","radio").attr("id","Jrating").attr("name","Jrating").prop("title",k.label).prop("checked",Z).css(touch_css).val(U);z&&z[0]==y&&(R.attr("checked","checked"),M=z[0]),A.append(R)}}X=srv.jQuery("<div>").attr("id","star_rating_"+d).addClass("rating-group stars").append('<span class="rating-prefix"></span>').append(A).append('<span class="rating-suffix"></span>');var Y=function(e){var r=srv.jQuery("#rating_"+d);__MS.validateField(r[0]),enableNext(e)},G={type:"rating",block_id:d,showCaptions:!!t.showCaptions,callback:Y,callback_data:a,hidden:I};srv.makeStars(X,G)}if(""!==E){I.val(E);L=!!sessionStorage.getItem("emailscore");srv.jQuery(document).one("mopinion_ready",function(e){e.detail.key===a&&setTimeout(function(){"stars"==t.type&&srv.jQuery("#star_rating_"+d).find('.ui-stars-star[data-value="'+E+'"]').click();jQuery("#rating_"+P).trigger("change"),L||(srv.send(!1,a),sessionStorage.setItem("emailscore",!0))},500)})}else M&&I.val(M);$block.append(I).append(X)}else if("nps"===e){M="";var J=srv.jQuery("<div>").addClass("choice-row");E="",P="",g=!!t.reverseScore&&t.reverseScore,_=void 0!==t.setScoreCookie&&t.setScoreCookie;if(g)for(y=10;0<=y;y--){$=getPreselectValue("nps",a);(Z=t.preselectScore&&$&&$==y)&&(E=y,P=d);w=d+"_"+y,S=srv.jQuery("<input>").attr("type","radio").attr("id","nps_"+w).attr("name","radioGroup_"+d).prop("checked",Z).on("click",function(){srv.setValue(this,e+"_"+d)}).css(touch_css).val(y);isActive(y,current_block)&&(S.prop("checked","checked"),M=y);x=srv.jQuery("<label>").attr("for","nps_"+w).attr("id","label_"+w).css(touch_css).html(y);var K=srv.jQuery("<div>").addClass("nps-choice").append(S).append(x);J.append(K)}else for(y=0;y<11;y++){var Z;$=getPreselectValue("nps",a);(Z=t.preselectScore&&$&&$==y)&&(E=y,P=d);w=d+"_"+y,S=srv.jQuery("<input>").attr("type","radio").attr("id","nps_"+w).attr("name","radioGroup_"+d).prop("checked",Z).on("click",function(){srv.setValue(this,e+"_"+d)}).css(touch_css).val(y);isActive(y,current_block)&&(S.prop("checked","checked"),M=y);x=srv.jQuery("<label>").attr("for","nps_"+w).attr("id","label_"+w).css(touch_css).html(y),K=srv.jQuery("<div>").addClass("nps-choice").append(S).append(x);J.append(K)}var X=srv.jQuery("<div>").addClass("rating-group nps-group").append(J);I=srv.jQuery("<input>").attr("type","hidden").attr("id",e+"_"+d).on("click",function(){showError(srv.jQuery(this),__MS.validateField(this))}).val(M);if(o&&I.addClass(n),_&&I.on("change",function(){var e=I.parents(".control-group").attr("id");srv[a].outer_modal?setCookie("MSanswer."+a+"."+e,I.val(),"session","/",void 0,!1):srv.callParentWindow({fn:"srv.setCookie('MSanswer."+a+"."+e+"','"+I.val()+"','session','/',undefined,false )"})}),$block.append(X).append(I),""!==E){I.val(E);L=!!sessionStorage.getItem("emailscore");srv.jQuery(document).one("mopinion_ready",function(e){e.detail.key===a&&setTimeout(function(){jQuery("#nps_"+P).trigger("change"),L||(srv.send(!1,a),sessionStorage.setItem("emailscore",!0))},500)})}}else if("ces"===e){z=t.checked,M="",g=!!t.reverseScore&&t.reverseScore,_=void 0!==t.setScoreCookie&&t.setScoreCookie,A=srv.jQuery("<div>").addClass("choice-row");for(var y in s){if("function"!=typeof(k=s[y])){checked=!1,z&&z[0]==y&&(checked=!0,M=z[0]);R=srv.jQuery("<input>").attr("type","radio").attr("id","Jrating").attr("name","Jrating").prop("title",k.label).css(touch_css).val(y);checked&&R.attr("checked",checked),A.append(R)}}Y=function(e){var r=srv.jQuery("#ces_"+d);__MS.validateField(r[0]),enableNext(e)};X=srv.jQuery("<div>").attr("id","ces_rating_"+d).addClass("rating-group ces").append('<span class="ces-prefix"></span>').append(A).append('<span class="ces-suffix"></span>'),I=srv.jQuery("<input>").attr("type","hidden").attr("id","ces_"+d).val(M),_&&I.on("change",function(){var e=I.parents(".control-group").attr("id");srv[a].outer_modal?setCookie("MSanswer."+a+"."+e,I.val(),"session","/",void 0,!1):srv.callParentWindow({fn:"srv.setCookie('MSanswer."+a+"."+e+"','"+I.val()+"','session','/',undefined,false )"})}),o&&I.addClass(n);G={type:"ces",block_id:d,showCaptions:!!t.showCaptions,callback:Y,callback_data:a,hidden:I};srv.makeStars(X,G),$block.append(X).append(I),g&&setTimeout(function(){for(y=1;y<=5;y++){var e=jQuery("#ces_rating_"+d+' div[data-value="'+y+'"]'),r=jQuery("#ces_rating_"+d+' div[data-value="'+(y-1)+'"]');e.insertBefore(r)}jQuery("#ces_rating_"+d).addClass("reversed")})}else if("section_break"===e)X=srv.jQuery("<div>").attr("id","section_description_"+d).addClass("section-description").html(t.description),$block.addClass("section").append(X);else if("matrix"===e){var ee=t.values,re=t.weights,te=srv.jQuery("<th>").addClass("matrix-subject-label"),ae=srv.jQuery("<tr>").append(te),se=srv.jQuery("<thead>").append(ae),oe=srv.jQuery("<tbody>");for(var ne in ee)if("function"!=typeof ee[ne]){var ie=srv.jQuery("<th>").addClass("matrix-answer-label").html("<div><span>"+ee[ne].label+"</span></div>");ae.append(ie)}for(var le in ae.append('<th class="matrix-spacer"></th>'),re)if("function"!=typeof re[le]){var de=srv.jQuery("<th>").addClass("matrix-answer-label").html("<div><span>"+re[le].label+"</span></div>");ae.append(de)}for(var y in s){if("function"!=typeof(k=s[y])){var ce=srv.jQuery("<td>").addClass("matrix-subject").html(k.label);je=srv.jQuery("<tr>").append(ce);I=srv.jQuery("<input>").attr("type","hidden").attr("id","matrix_"+d+"_"+y).on("blur",function(){showError(srv.jQuery(this),__MS.validateField(this))});for(var ne in o&&I.addClass(n),ee)if("function"!=typeof ee[ne]){var ue=srv.jQuery("<input>").attr("type","radio").attr("name","matrix_"+d+"_"+y+"_value").attr("id","matrix_"+d+"_"+y+"_value_"+ne).attr("title",ee[ne].label).on("click",function(){setMatrix(this)}).css(touch_css).val(ee[ne].label),ve=srv.jQuery("<label>").attr("for","matrix_"+d+"_"+y+"_value_"+ne).css(touch_css),pe=srv.jQuery("<div>").addClass("matrix-answer-inner").append(ue).append(ve),fe=srv.jQuery("<td>").addClass("matrix-answer").attr("data-label",ee[ne].label).append(pe);je.append(fe)}for(var le in je.append('<td class="matrix-spacer"></td>'),re)if("function"!=typeof re[le]){var ye=srv.jQuery("<input>").attr("type","radio").attr("name","matrix_"+d+"_"+y+"_weight").attr("id","matrix_"+d+"_"+y+"_weight_"+le).attr("title",re[le].label).on("click",function(){setMatrix(this)}).css(touch_css).val(re[le].label),me=srv.jQuery("<label>").attr("for","matrix_"+d+"_"+y+"_weight_"+le).css(touch_css),he=srv.jQuery("<div>").addClass("matrix-answer-inner").append(ye).append(me),_e=srv.jQuery("<td>").addClass("matrix-answer").attr("data-label",re[le].label).append(he);je.append(_e)}je.append(I),oe.append(je)}}X=srv.jQuery("<div>").attr("id","matrix_"+d).addClass("matrix-group");var ge=srv.jQuery("<table>").addClass("table table-striped matrix-table").append(se).append(oe);X.append(ge),$block.append(X)}else if("likert"===e){ee=t.values,te=srv.jQuery("<th>").addClass("likert-subject-label"),ae=srv.jQuery("<tr>").append(te),se=srv.jQuery("<thead>").append(ae),oe=srv.jQuery("<tbody>");for(var ne in ee)if("function"!=typeof ee[ne]){var be=srv.jQuery("<th>").addClass("likert-answer-label").html("<div><span>"+ee[ne].label+"</span></div>");ae.append(be)}for(var y in s){if("function"!=typeof(k=s[y])){ce=srv.jQuery("<td>").addClass("likert-subject").html(k.label),I=srv.jQuery("<input>").attr("type","hidden").attr("id","likert_"+d+"_"+y).on("blur",function(){showError(srv.jQuery(this),__MS.validateField(this))});o&&I.addClass(n);var je=srv.jQuery("<tr>").append(ce);for(var ne in ee){C=ee[ne];var ke=srv.jQuery("<input>").attr("type","radio").attr("name","likert_"+d+"_"+y).attr("id","likert_"+d+"_"+y+"_rdo_"+ne).attr("title",C.label).on("click",function(){setLikert(this)}).css(touch_css).val(C.label),Qe=srv.jQuery("<label>").attr("for","likert_"+d+"_"+y+"_rdo_"+ne).css(touch_css),we=srv.jQuery("<div>").addClass("likert-answer-inner").append(ke).append(Qe);$cell=srv.jQuery("<td>").addClass("likert-answer").attr("data-label",C.label).append(we),je.append($cell)}je.append(I),oe.append(je)}}X=srv.jQuery("<div>").attr("id","likert_"+d).addClass("likert-group"),ge=srv.jQuery("<table>").addClass("table table-striped likert-table").append(se).append(oe);X.append(ge),$block.append(X)}else if("contact"===e){var Ce=srv.jQuery("<div>").addClass("contact-wrapper");if(s.name.show){var Se=srv.jQuery("<div>").addClass("name-wrapper");if(s.title.show){var xe=srv.jQuery("<select>").attr("id","contact_"+d+"_title").attr("data-contact",!0).addClass("span2").css(touch_css),Te=Object.keys(s.title.options)[0];for(var Me in""!==s.title.options[Te]&&(s.title.options[0]=""),s.title.required&&(xe.addClass(n),f.append(u)),s.title.options){var Ee=s.title.options[Me],Pe=srv.jQuery("<option>").val(Ee).html(Ee);xe.append(Pe)}xe=srv.jQuery("<div>").addClass("title").append(xe);Se.append(xe)}if(s.name.combine)name_placeholder=s.name.placeholder||"";else{var $e=srv.jQuery("<input>").attr("id","contact_"+d+"_firstname").attr("data-contact",!0).attr("type","text").attr("placeholder",s.name.subelements.firstname.placeholder||"").css(touch_css);s.name.required&&$e.addClass(n),$e=srv.jQuery("<div>").append($e),Se.append($e),name_placeholder=s.name.subelements.lastname.placeholder||""}var Ne=srv.jQuery("<input>").attr("id","contact_"+d+"_name").attr("data-contact",!0).attr("type","text").attr("placeholder",name_placeholder).css(touch_css);s.name.required&&(Ne.addClass(n),f.append(u)),Ne=srv.jQuery("<div>").append(Ne),Se.append(Ne)}if(s.email.show){var Oe=srv.jQuery("<input>").attr("id","contact_"+d+"_email").attr("type","text").attr("data-contact",!0).attr("placeholder",s.email.placeholder||"").addClass("email").css(touch_css);s.email.required&&Oe.addClass(n),Oe=srv.jQuery("<div>").append(Oe);var We=srv.jQuery("<div>").addClass("email-wrapper").append(Oe)}if(s.phone.show){var Le=srv.jQuery("<input>").attr("id","contact_"+d+"_phone").attr("type","text").attr("data-contact",!0).attr("placeholder",s.phone.placeholder||"").addClass("phone").css(touch_css);if(s.phone.required&&Le.addClass(n),s.phone2.show){var Ae=srv.jQuery("<input>").attr("id","contact_"+d+"_phone2").attr("type","text").attr("data-contact",!0).attr("placeholder",s.phone2.placeholder||"").addClass("phone").css(touch_css);s.phone2.required&&Ae.addClass(n),Ae=srv.jQuery("<div>").append(Ae)}Le=srv.jQuery("<div>").append(Le);var Ie=srv.jQuery("<div>").addClass("phone-wrapper").append(Le).append(Ae)}Ce.append(Se).append(We).append(Ie),$block.append(Ce)}else if("screenshot"===e){X=jQuery("<div>").attr("id","screenshot_element_"+d).addClass("section-screenshot").html('<i class="fa fa-camera"></i>').on("click",function(e){e.preventDefault();var r=srv[a].block_params[d].properties.hasOwnProperty("maskedSelectors")?srv[a].block_params[d].properties.maskedSelectors:[];srv[a].outer_modal?setTimeout(function(){srv.initCapture({embedded:!0,block_id:d,key:a,maskSelectors:r})}):setTimeout(function(){srv.callParentWindow({fn:"srv.initCapture",data:{block_id:d,supportsPointerEvents:supportsPointerEvents(),key:a,maskedSelectors:r}})})});srv.jQuery("<div>").addClass("remove-capture").html('<i class="fa fa-times"></i>').appendTo(X),srv.jQuery("<div>").addClass("detect-capture").html('<i class="fa fa-check"></i>').appendTo(X);$block.addClass("section").append(X),1==t.bottomScreen&&($block.addClass("absolute"),r&&X.addClass("tooltip").append('<span class="tooltip">'+current_block.tooltip+"</span>"),o&&X.append(u));srv.jQuery("<input>").attr({type:"hidden",id:"dom_"+d}).prependTo($block),srv.jQuery("<input>").attr({type:"hidden",id:"selector_"+d}).prependTo($block);var Fe=srv.jQuery("<input>").attr({type:"hidden",id:"screenshot_"+d}).on("blur",function(){showError(srv.jQuery(this),__MS.validateField(this))}).prependTo($block);o&&Fe.addClass(n)}else if("link"===e){var Be=current_block.properties.hyperlinkhref||"",qe=current_block.properties.hyperlinktext||"";if(current_block.properties.show_as_buttons)var Re="btn";else Re="";if(Be.indexOf("http://")<0&&Be.indexOf("https://")<0)var He=current_block.properties.hyperlinkprotocol||"";else He="";if("link"==current_block.properties.linktype)qe=qe.replace("/*",'<a href="'+He+Be+'" class="'+Re+'" target="_blank">').replace("*/","</a>");else if("function"==current_block.properties.linktype){var Ve=current_block.properties.linktype_function;qe="close_modal"==Ve?qe.replace("/*","<a href='javascript:;' onclick='srv.callParentWindow({fn:\"srv.closeModal\",data:\""+a+"\"})' class='"+Re+"' >").replace("*/","</a>"):"close_embedded"==Ve?qe.replace("/*","<a href='javascript:;' onclick=\"srv.jQuery('.close_custom_bg').click();\" class='"+Re+"' >").replace("*/","</a>"):"next_page"==Ve?qe.replace("/*","<a href='javascript:;' onclick='srv.nextPage(false,\""+a+"\")' class='"+Re+"' >").replace("*/","</a>"):"prev_page"==Ve?qe.replace("/*","<a href='javascript:;' onclick='srv.prevPage(false,\""+a+"\")' class='"+Re+"' >").replace("*/","</a>"):qe.replace("/*",'<span data-attr="unknown function"').replace("*/","</span>")}else qe=qe.replace("/*",'<a href="'+He+Be+'" class="'+Re+'" target="_blank">').replace("*/","</a>");X=srv.jQuery("<div>").attr("id","link_"+d).addClass("link_block").append(qe),"link"==current_block.properties.linktype&&X.on("click",function(){srv.callParentWindow({fn:"srv.triggerEvent",data:{event:"redirect",key:a,formName:srv[a].survey_properties.name,url:He+Be}})}),$block.append(X)}else if("website_data"===e){for(var y in s){var De=s[y],ze=e+"_"+De.type+"_"+d+"_"+y;ze=ze.replace(/\W/g,"");srv.jQuery("<input>").attr({type:"hidden",id:ze,name:ze}).appendTo($block);if(srv[a].outer_modal||PUBLIC_LANDING)fetchVariable({type:De.type,value:De.value,hidden_id:ze,embedded:!0,key:a});else{var Ue={type:De.type,value:encodeURIComponent(De.value),hidden_id:ze,key:a};Ue=JSON.stringify(Ue),srv.callParentWindow({fn:"srv.fetchVariable",data:Ue})}}$block.css("display","none")}else $block=srv.jQuery("<div>").html("[unknown type]");return $block}function buildForm(l){var e=srv[l].error_messages,r=srv[l].survey_text;e.deflt=r.deflt?r.deflt:"Something went wrong",e.required=r.required?r.required:"This field is required",e.required_multi=r.required_multi?r.required_multi:"All fields are required",e.invalid_number=r.invalid_number?r.invalid_number:"This is not a valid number",e.invalid_phone=r.invalid_phone?r.invalid_phone:"This is not a valid phone number",e.invalid_email=r.invalid_email?r.invalid_email:"This is not a valid email address",e.too_short=r.too_short?r.too_short:"The answer is too short",e.too_long=r.too_long?r.too_long:"The answer is too long",themeClass=srv[l].theme_class||"",srv.jQuery(document).one("touchstart",function(){user_touching=!0}),supportsPointerEvents(!0);var t=srv.jQuery("#"+this[l].div_name);if(t.addClass("mopinion-survey-content"),!srv[l].outer_modal||!t.find('[data-key="'+l+'"]').length){var a=!1;if(void 0!==srv[l].survey_properties){var s=!1,o=!1,d=!1,n=srv.jQuery("<div>").attr("id","lastPage").addClass("last-page").css({"min-height":"100px",display:"none"}).html(srv[l].survey_properties.exit_content),i=srv.jQuery("<div>").addClass("completed-anim").append('<i class="fa fa-check"></i>');n.prepend(i);var c=srv.jQuery("<div>");if(!this[l].outer_modal){s=srv.jQuery("<div>").attr("id","surveyHead"),o=srv.jQuery("<div>").attr("id","surveyFoot");if(srv[l].survey_properties.footer&&o.html("<p>"+srv[l].survey_properties.footer+"</p>"),""!=srv[l].survey_properties.logo)var u=srv.jQuery("<img>").attr("id","customerLogo").attr("src",srv[l].survey_properties.logo);var v=srv.jQuery("<div>").attr("id","surveyTitle").addClass("srv-title main-title").html("<h1>"+srv[l].survey_properties.title+"</h1>");s.append(u).append(v)}$page=srv.jQuery("<div>").attr("id","page1"),srv.jQuery(srv[l].block_layout).each(function(e,r){if(current_block=srv[l].block_params[r],"object"==typeof current_block){if("page_break"!==current_block.typeName)1==current_block.properties.bottomScreen?(d=jQuery(srv.generateHTML(current_block.typeName,l)),current_block.properties.hide_on_init&&srv[l].hide_on_init.push(current_block.typeName+"_"+current_block.id)):($block=jQuery(srv.generateHTML(current_block.typeName,l)),current_block.properties.hide_on_init&&srv[l].hide_on_init.push(current_block.typeName+"_"+current_block.id),$page.append($block));else{srv[l].page_count++;var t=current_block.properties,a=srv[l].survey_properties.advanced.hideSubNavigation?"none":"inline-block",s=srv.jQuery("<div>").addClass("form-actions");if(s.append("<span>"+current_block.title+"</span>"),1!=t.isFirst&&""!==srv.jQuery.trim(t.prevLabel)&&(_=srv.jQuery("<button>").attr({id:"btn_prev_"+current_block.id,style:"display:"+a}).addClass("btn btn-previous pull-left").on("click",function(){srv.prevPage(!1,l)}).css(touch_css).html(t.prevLabel),s.append(_)),$next_btn=srv.jQuery("<button>").attr({id:"btn_next_"+current_block.id,style:"display:"+a}).addClass("btn btn-next pull-right").on("click",function(){srv.nextPage(!1,l)}).css(touch_css).html(t.nextLabel),void 0!==t.isAction&&1==t.isAction&&$next_btn.addClass("btn-primary btn-submit"),t.autopost){var o,n=$page[0].children.length,i=$page[0].children[n-1].childNodes;for(e=0;e<i.length;e++)("hidden"==(o=i[e]).type&&null===o.id.match(/checkbox/gi)||null!==o.id.match(/select/gi))&&(s.addClass("autopost"),$node=srv.jQuery(o),$node.on("change.autopost",function(){srv.nextPage(!1,l);var e=srv[l].current_page,r=srv[l].current_page-1;jQuery("#page"+r+" .form-actions").removeClass("autopost"),jQuery(this).off("change.autopost"),setTimeout(function(){0!==jQuery(".alert.alert-danger").length&&jQuery("#page"+e+" .form-actions").removeClass("autopost")})}))}s.append($next_btn),$page.append(s),c.append($page),$page=srv.jQuery("<div>").attr("id","page"+srv[l].page_count).addClass("page-break").css("display","none")}updateQuestionCount(current_block,l)}});var p=this.getLanguage("btnSubmitText",l),f=srv[l].survey_properties.advanced.hideNavigation?"none":"inline-block",y=srv.jQuery("<button>").attr({id:"surveySubmitBtn",style:"display:"+f}).addClass("btn btn-primary btn-submit pull-right").on("click",function(){srv.submitSurvey(l)}).css(touch_css).html(p),m=srv.jQuery("<div>").addClass("form-actions");if(1<this[l].page_count){var h=this.getLanguage("btnLastBackText",l),_=srv.jQuery("<button>").addClass("btn btn-previous").attr("style","display:"+f).on("click",function(){srv.prevPage(!1,l)}).html(h);m.append(_)}if(m.append(y),$page.append(m),c.append($page),this[l].survey_properties.advanced.showProgressbar){var g=srv.jQuery("<div>").attr("id","progress").addClass("progress");if(this[l].survey_properties.advanced.toggleDotview){g.addClass("dot-layout");for(var b=this[l].page_count,j=1;j<=b;j++){var k=1==j?" active":"",Q=j==b?" last":"",w=100/(b-1),C=jQuery("<div>").addClass("progress-dot").text(j);jQuery("<div>").addClass("progress-wrap"+k+Q).css("width",w+"%").attr("data-pagecount",j).append(C).appendTo(g)}jQuery('.progress_dot[data-pagecount="1"]').addClass("active")}else g.addClass("bar-layout").append('<div id="progressBar" class="bar" style="width: 0%;"></div>')}var S=srv.jQuery("<div>").append(s).append(g).append(c).append(n).append(o).css("opacity","0");srv[l].outer_modal?S.addClass("is-embed"):"slide"==srv[l].slider.type?S.addClass("mopinion-slide"):S.addClass("is-modal"),S.attr("data-key",l).addClass("mopinion-survey-output "+themeClass),d&&S.append(d),srv[l].initBlockRules(),srv[l].initSurveyRules(),srv[l].outer_modal||resizeListener("surveyContent",l),a=!0}else if(this[l].outer_modal){if("slide"!==srv[l].slider.type&&srv[l].show_button&&(S=srv.showButton(l)),isPreview&&(srv.jQuery("#surveyPreviewButtonValue").html(!srv[l].button||srv[l].button.hide?"Yes":"No"),!srv[l].button||srv[l].button.hide)){var x=srv.jQuery("<button>").addClass("force-modal-btn").html("Force open").css(touch_css).on("click",function(){srv.openModal(!0,!1)});srv.jQuery("#surveyPreviewButtonValue").append(x)}}else S=srv.jQuery("<div>").addClass("alert alert-error").html("Error loading survey");for(var T in t.append(S),srv[l].survey_text.errors)srv[l].error_messages[T]=srv[l].survey_text.errors[T];for(var j in srv.jQuery("input[type=text], textarea").keyup(function(){enableNext(l)}),srv.jQuery("input[type=checkbox], input[type=radio]").click(function(){enableNext(l)}),srv.jQuery("input[type=text], textarea").blur(function(){showError(srv.jQuery(this),__MS.validateField(this))}),srv.jQuery("select").change(function(){showError(srv.jQuery(this),__MS.validateField(this)),enableNext(l)}),void 0!==srv[l].survey_properties&&"disable"==srv[l].survey_properties.advanced.next_button_behaviour?srv.jQuery(".btn-next, #surveySubmitBtn").prop("disabled",!0):void 0!==srv[l].survey_properties&&"hide"==srv[l].survey_properties.advanced.next_button_behaviour&&srv.jQuery(".btn-next, #surveySubmitBtn").hide(),srv[l].hide_on_init)hideBlock(srv[l].hide_on_init[j],!1,!1,l);if(initPostMessage(l),srv.getMeta({key:l}),isPreview&&"-"==srv.jQuery("#surveyPreviewMessageContent").html()&&srv.jQuery("#surveyPreviewMessageContent").html("All good!"),srv[l].outer_modal||__MS.hammerTime(),t.find("select").length){var M=t.find("select");srv.niceSelect(M,!1,l),M.each(function(e,r){srv.jQuery(r)})}if(setTimeout(function(){enableNext(l)},500),S&&setTimeout(function(){S.animate({opacity:1},{duration:225,display:"block",complete:function(){srv.jQuery("#branding").addClass("anim").attr("style","display:block!important;text-align:center;")}})}),srv[l].is_loading=!1,"slide"===srv[l].slider.type&&(srv[l].outer_modal&&srv.preloadSlider(l,!1),srv[l].outer_modal||t.closest("#surveyBody").addClass("mopinion-slide")),a&&srv[l].outer_modal){EventInitializer("form_loaded");var E="";try{E=srv[l].survey_properties.name}catch(T){}srv.triggerEvent({event:"loaded",key:l,formName:E}),srv.triggerEvent({event:"ready",key:l,formName:E})}else if(a&&!srv[l].outer_modal){E="";try{E=srv[l].survey_properties.name}catch(T){}srv.triggerEvent({event:"ready",key:l,formName:E}),srv.callParentWindow({fn:"srv.triggerEvent",data:{event:"ready",key:l,formName:E}})}if(!srv[l].outer_modal&&void 0!==srv[l].survey_properties&&srv[l].survey_properties.advanced.hasOwnProperty("analytics_integration")&&setTimeout(function(){addAnalytics(srv[l].survey_properties.advanced.analytics_integration,l)},500),PUBLIC_LANDING)landingIframe(!!srv[l].survey_properties.advanced.enableCustomBackground,!!srv[l].survey_properties.advanced.landingspageTransparency,srv[l].survey_properties.advanced.landingspageTheme?srv[l].survey_properties.advanced.landingspageTheme:"dark",!!srv[l].survey_properties.advanced.landingspageClose&&srv[l].survey_properties.advanced.landingspageClose)}}function EventHandler(e,r){srv.eventsHandlers[e].push(r)}function EventInitializer(e){for(var r in srv.eventsHandlers[e]){var t=srv.eventsHandlers[e][r];"function"==typeof t&&setTimeout(t,350)}}function triggerEvent(e){var r=e.element||document;if("function"==typeof CustomEvent){var t=new CustomEvent("mopinion_"+e.event,{bubbles:!1,detail:e});r.dispatchEvent(t)}else{(t=document.createEvent("CustomEvent")).initCustomEvent("mopinion_"+e.event,!1,!1,e),r.dispatchEvent(t)}}function landingIframe(e,r,t,a){var s=getParameterByName("mail_url",LOCATION_REF);if(s&&e&&(null!==s.match(/^https?:\/\/[a-zA-Z0-9]+\.[a-zA-Z]+/gi)||null!==s.match(/^https?:\/\/www\.[a-zA-Z0-9]+\.[a-zA-Z]+/gi)||null!==s.match(/^https?:\/\/[a-zA-Z]+\.[a-zA-Z0-9]+\.[a-zA-Z]+/gi))){var o=jQuery("<iframe>").attr({src:s,id:"mailUrl"}).addClass("bg__mailing_Iframe"),n=jQuery("<a>").addClass("close_custom_bg").addClass(t).attr({href:"javascript:;"}).on("click",function(){jQuery("#surveyWrap").remove(),jQuery(this).remove(),jQuery("#mailUrl").css("z-index","1001"),jQuery("html,body").css("overflow","hidden"),jQuery("#publicSurveyBody").removeClass("dark light transparent")});if(a)jQuery("<span>").addClass("close_custom_bg_lbl").addClass(t).html(a).appendTo(n);jQuery("#publicSurveyBody").addClass("customBackground").addClass(t).append(o,n),r&&jQuery("#publicSurveyBody").addClass("transparent")}else s&&e&&window.console&&console.log("The given url seems to be incorrect: "+s)}function appendScript(e,r,t,a,s){var o=document.getElementsByTagName("head")[0],n=document.getElementById(r);n&&o.removeChild(n);var i=document.createElement("script");if(i.type="text/javascript",i.id=r,i.src=e,t)for(var l in t)i[l]=t[l];if(a)var d=window.setInterval(function(){srv.log("waiting for "+a+" to load"),"function"==typeof window[a]&&(srv.log(a+" loaded"),!0,window.clearInterval(d),o.appendChild(i))},10);else o.appendChild(i);if("function"==typeof s){var c=!1;i.onload=i.onreadystatechange=function(){if(!(c||this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState)){c=!0;try{s()}catch(e){}}}}}function appendStyle(e,r){var t=document.getElementsByTagName("head")[0];if(!document.getElementById(r)){var a=document.createElement("link");a.type="text/css",a.rel="stylesheet",a.id=r,a.href=e,t.appendChild(a)}}function log(e,r,t){if(t&&"log"!=t){if("warn"==t){if(this.show_log||!0===r)try{console.warn(e)}catch(e){}}else if("info"==t){if(this.show_log||!0===r)try{console.info(e)}catch(e){}}else if("error"==t)throw new Error(e)}else if(this.show_log||!0===r)try{console.log(e)}catch(e){}}function prevPage(e,r){srv.log("page_nr "+e);var t=srv.jQuery('[data-key="'+r+'"]');this[r].page_history[this[r].current_page]?(srv.log("getting page from history"),this[r].prev_page=this[r].page_history[this[r].current_page]):srv.log("natural flow"),$curr_page_div=t.find("#page"+this[r].current_page),$new_page_div=t.find("#page"+this[r].prev_page),this[r].next_page=this[r].current_page,$new_page_div.css("display","block"),$curr_page_div.css("display","none"),this[r].current_page=this[r].prev_page,this[r].prev_page--,updateProgress(r),updateHeader(r),scrollToSurveyElement(0,r)}function nextPage(e,r){if(srv[r].lock_submit)return!1;var t=srv[r].page_map[this[r].current_page],a=__MS.validateAll(t,showError),s=srv.jQuery('[data-key="'+r+'"]');if(a){if(srv[r].form_completion_ratio=Math.round(srv[r].current_page/srv[r].page_count*100),scroll_top=0,this[r].prev_page=this[r].current_page,$prev_page_div=s.find("#page"+this[r].prev_page),this[r].next_page&&(e=this[r].next_page,this[r].page_history[this[r].next_page]=this[r].current_page),e?this[r].current_page=e:this[r].current_page++,-1==e)s.find("#lastPage").css("display","block").find(".completed-anim").addClass("do-anim"),s.find("#surveyTitle h1").text(this.getLanguage("lastPageTitle",r)),s.find("#surveyDescription").css("display","none"),s.find("#lastPage").parent().find(".control-group").length&&s.find("#lastPage").parent().find(".control-group").css("display","none");else{s.find("#page"+this[r].current_page).css("display","block");this.send(!1,r)}$prev_page_div.css("display","none"),this[r].next_page=!1}else srv.log(srv[r].error_messages.deflt,!1,"warn"),first_error=srv.jQuery("#"+__MS.errors[0]).parent(),scroll_top=first_error.offset().top;updateProgress(r),updateHeader(r),scrollToSurveyElement(scroll_top,r),enableNext(r)}function updateQuestionCount(e,r){"matrix"==e.typeName||"likert"==e.typeName?srv[r].question_count=srv[r].question_count+Object.keys(e.properties.elements).length:"section_break"!=e.typeName&&"page_break"!=e.typeName&&srv[r].question_count++}function updateHeader(e){var r=srv.jQuery('[data-key="'+e+'"]');1<srv[e].current_page||srv[e].current_page<0?r.find("#surveyDescription").css("display","none"):(r.find("#surveyTitle").css("display","block"),r.find("#surveyDescription").css("display","block"))}function updateProgress(e){if(srv[e].outer_modal||srv.jQuery("html").removeClass(function(e,r){return(r.match(/(^|\s)mopinion-onpage-\S+/g)||[]).join(" ")}).addClass("mopinion-onpage-"+(-1==srv[e].current_page?"last":srv[e].current_page)),-1==srv[e].current_page)100,srv.jQuery("#progress").remove();else if(srv[e].survey_properties.advanced.toggleDotview)srv.jQuery(".progress-wrap").removeClass("active completed"),srv.jQuery('.progress-wrap[data-pagecount="'+srv[e].current_page+'"]').addClass("active"),srv.jQuery('.progress-wrap[data-pagecount="'+srv[e].current_page+'"]').prevAll().addClass("completed");else{var r=srv[e].form_completion_ratio;srv.jQuery("#progress").children(".bar").css("width",r+"%")}}function setValue(e,r,t){var a=srv.jQuery("#"+r);if($id_nr=r.replace(e.type+"_",""),"checkbox"==e.type){$new_value={};a.val().split(",");srv.jQuery("input[name="+e.name+"]:checked").each(function(e,r){var t=r.id.split("_"),a=t[t.length-1];r.value&&($new_value["ch_"+a]=r.value)}),a.val(JSON.stringify($new_value)),"{}"==a.val()&&a.val("")}else if(t){var s=e.id.split("_"),o=s[s.length-1];$new_value={},$new_value["rdo_"+o]=e.value,a.val(JSON.stringify($new_value))}else a.val(e.value);a.val(a.val()).trigger("change"),showError(a,{state:!0}),__MS.unsetError(a)}function send(a,s){var o=srv.jQuery('[data-key="'+s+'"]');setLock(s);var n=function(e){if(1!=srv[s].testMode)return e.code=200,e.msg="Everything is allright. No ...really its ok, believe me. (please...)",void t(e);var r="Failed to send survey!";(e.verbose||!1)&&(r+="\n\nCode:"+e.code+"\nMessage:"+e.error),srv.log(r,!0),clearLock(s),o.find("#surveySubmitBtn").removeClass("is-submitting").removeClass("btn-primary").addClass("btn-danger").html('<i class="fa fa-exclamation-circle"></i> Failed!, click to retry.').prop("disabled",!1)},t=function(e){if(srv.log("Api Response:\n Code:"+e.code+"\n"+e.msg,!1,"info"),srv[s].lock_submit=!1,clearLock(s),e&&200==e.code)if(e.id&&(srv[s].followUpId=e.id,srv[s].sendMode="upsert"),a){srv[s].outer_modal?setCookies({type:"sent",key:s}):srv.callParentWindow({fn:"srv.setCookies",data:{type:"sent",key:s}});var r={timeout:srv[s].survey_properties.timeout};srv[s].survey_properties.notify&&srv[s].survey_properties.notify.send&&(notify=srv[s].survey_properties.notify,r.to=srv.jQuery("#"+srv[s].survey_properties.notification_email).val(),r.subject=notify.subject||"",r.sender=notify.sender||"",r.message=notify.message||"",o.find("#lastPage").html(srv[s].survey_properties.exit_content.replace("%email%",r.to)),o.find("#lastPage").prepend('<div class="completed-anim do-anim"><i class="fa fa-check"></i></div>')),srv[s].survey_properties.modal&&o.find("#lastPage").append('<div id="autoClose" class="countdown muted" style="position:absolute; bottom:40px; right:20px;">window closes in <span id="countdown"></span> seconds</div>'),postSubmit(r,s);var t={event:"feedback_sent",key:s,formName:srv[s].survey_properties.name};e.data&&e.data.data&&srv[s].survey_properties.advanced.return_feedback&&(t.feedback=srv.jQuery.map(e.data.data,function(r){var e=Object.keys(srv[s].block_params).filter(function(e){return srv[s].block_params[e].import_var==r.label})[0],t="";try{t=srv[s].block_params[e].title}catch(e){}if("image"!==r.type&&"dom"!==r.type)return srv.jQuery.extend(r,{title:t})})),srv[s].outer_modal?(srv.triggerEvent(t),srv.clearCaptureEvents(s)):(srv.callParentWindow({fn:"srv.triggerEvent",data:t}),srv.callParentWindow({fn:"srv.clearCaptureEvents",data:s})),"slide"===srv[s].slider.type&&setTimeout(function(){srv.callParentWindow({fn:"srv.closeSlider",data:s}),setTimeout(location.reload(),750)},5e3)}else{t={event:"next",key:s,formName:srv[s].survey_properties.name};e.data&&e.data.data&&srv[s].survey_properties.advanced.return_feedback&&(t.feedback=srv.jQuery.map(e.data.data,function(r){var e=Object.keys(srv[s].block_params).filter(function(e){return srv[s].block_params[e].import_var==r.label})[0],t="";try{t=srv[s].block_params[e].title}catch(e){}if("image"!==r.type&&"dom"!==r.type)return srv.jQuery.extend(r,{title:t})})),srv[s].outer_modal?srv.triggerEvent(t):srv.callParentWindow({fn:"srv.triggerEvent",data:t})}else n(e)},i={feedback:[]};srv.jQuery(srv[s].survey_send_options.data).each(function(e,r){if(r){var t=r.by_name?srv.jQuery('input[name="'+r.field+'"]:checked'):srv.jQuery("#"+r.field),a="checkbox"==t.attr("type")?t.prop("checked"):t.val();i.feedback.push({label:r.label,value:a,type:r.type})}}),!1!==srv[s].survey_send_options.force_customer&&i.feedback.push({value:srv[s].survey_send_options.force_customer.value,type:"customer",label:srv[s].survey_send_options.force_customer.label}),i.feedback.push({value:navigator.userAgent,type:"agent",label:"User Agent"});var r=getParameterByName("parent",document.location),l="";if(r)try{l=document.location.href.split("&parent=")[1].split("&cip=")[0]}catch(e){l=r}else l=LOCATION_REF;i.feedback.push({value:l,type:"url",label:"url"}),i.feedback.push({value:srv[s].document_title,type:"category",label:"Page title"}),i.feedback.push({value:1,type:"role",label:"Role"}),i.feedback.push({value:srv[s].survey_properties.name,type:"category",label:"Survey"}),i.feedback.push({value:srv[s].window_viewport,type:"viewport",label:"Viewport"}),srv[s].trigger_method&&i.feedback.push({value:srv[s].trigger_method,type:"category",label:"Form trigger"}),i.feedback.push({value:srv[s].form_completion_ratio,type:"form_completion",label:"Form completion percentage"}),"insert"!==srv[s].sendMode&&i.feedback.push({value:srv[s].followUpId,type:"id",label:"Survey ID"});var e={token:srv[s].survey_send_options.token,domain:srv[s].survey_send_options.domain,surveyId:srv[s].survey_properties.id,ip:srv[s].cip||0,data:i,mode:srv[s].sendMode};srv[s].survey_send_options.preview?(srv.log("Preview mode, not sending"),clearLock(s)):this.request("send",e,t,n,!1,s)}function request(e,r,t,a,s,o){a||(a=function(){srv.log("Error processing request",!0,"warn")});var n="https://"+srv[o].domain;srv.jQuery.ajax({async:!0,url:n+"/survey/public/"+e,dataType:"json",type:"POST",data:r,error:a,success:t})}function submitSurvey(e){if(srv[e].lock_submit)return!1;var r=srv.jQuery('[data-key="'+e+'"]');r.find("#surveySubmitBtn").prop("disabled",!0);var t=srv[e].page_map[this[e].current_page];__MS.validateAll(t,showError)?(r.find("#surveySubmitBtn").data("buttonContent",r.find("#surveySubmitBtn").html()).html('<i class="fa fa-refresh"></i>').addClass("btn-primary").removeClass("btn-danger").addClass("is-submitting"),srv[e].form_completion_ratio=Math.round(srv[e].current_page/srv[e].page_count*100),this.send(!0,e)):(srv.log(srv[e].error_messages.deflt,!1,"warn"),r.find("#surveySubmitBtn").prop("disabled",!1),first_error=srv.jQuery("#"+__MS.errors[0]).parent(),scroll_top=first_error.offset().top,scrollToSurveyElement(scroll_top,e))}function openModal(e,r){if(!r){if(1!==ALL_KEYS.length){try{srv.log("Key needed when multiple forms are initialized",!0,"warn")}catch(e){}return}r=ALL_KEYS[0]}if(-1!=ALL_KEYS.indexOf(r)){if("slide"!==srv[r].slider.type){if(getCookie("MSopened")==r&&!e||srv[r].modal_open){var t="Not opening, reason: ";srv[r].modal_open?t+="Already open":getCookie("MSopened")==r&&(t+="Got a cookie, and not forced by user"),isPreview&&srv.jQuery("#surveyPreviewMessageContent").html(t),srv.log(t)}else{e&&srv.log("User forced opening of modal",!1,"info"),srv[r].modalFirst=!0;var a=srv.jQuery("#"+srv[r].div_name),s=srv.jQuery("<div>").attr("id","surveyMask"),o=srv.jQuery("<div>").attr("id","surveyModalLoader").addClass("survey-modal-loader").append('<svg class="circular-spin" viewBox="25 25 50 50"><circle class="stroke-path" cx="50" cy="50" r="20" fill="none" stroke-width="2" stroke-miterlimit="10"/></svg>'),n="https://"+srv[r].domain+"/survey/public/modal?&key="+r+"&domain="+srv[r].domain+"&version="+srv[r].version+"&parent="+document.location,i=srv.jQuery("<div>").attr({id:"surveyWindowWrap","data-parent-for":r}).addClass("surveyWindowWrap").css({position:"fixed",top:0,left:0,right:0,"z-index":2000000001,bottom:0,"overflow-y":"auto","-webkit-overflow-scrolling":"touch","backface-visibility":"hidden",width:"100%","min-height":"100%"}).on("click",function(){s.click()}),l=srv.jQuery("<iframe>").attr("id","surveyWindow").attr("data-key",r).attr("src",n).attr("frameBorder",!1).attr("allowTransparency",!0).addClass("surveyWindow").css({border:"none","border-radius":"2px",position:"absolute",top:"50px",left:0,right:0,"margin-left":"auto","margin-right":"auto","max-width":"480px","z-index":2000000001,"margin-bottom":50,"box-shadow":"0 8px 17px 0 rgba(0,0,0,0.2)",opacity:0}).appendTo(i);handleIframeWidth(l),a.append(s).append(o),s.animate({opacity:.15},{complete:function(){srv.jQuery("html,body").addClass("mopinion-modal-active"),a.append(i);var e="";try{e=srv[r].outerProperties.name}catch(e){}srv.triggerEvent({event:"shown",key:r,formName:e}),s.on("click",function(){srv.closeModal(r)}),srv[r].modal_open=!0,setCookies({type:"open",key:r}),srv.hideLoader()}}),srv.jQuery(window).on("resize orientationchange",function(){handleIframeWidth(l)})}return!0}srv.openSlider(e,r)}else srv.open({key:r,show_button:!1,trigger_method:"force"})}function closeModal(r){if("slide"!==srv[r].slider.type){var t=srv.jQuery("#surveyMask"),e=srv.jQuery('[data-key="'+r+'"]'),a=e.closest(".surveyWindowWrap");srv.clearCaptureEvents(r),e.animate({opacity:0},{duration:300,complete:function(){srv[r].modalFirst=!1,a.remove(),t.animate({opacity:0},{duration:300,complete:function(){t.remove(),srv[r].modal_dismissed=!0,srv[r].modal_open=!1,srv.hideLoader(),srv.jQuery("html,body").removeClass("mopinion-modal-active");var e="";try{e=srv[r].outerProperties.name}catch(e){}srv.triggerEvent({event:"hidden",key:r,formName:e})}})}})}else srv.closeSlider(r)}function hideLoader(){srv.jQuery("#surveyModalLoader").fadeOut(500).promise().done(function(){srv.jQuery(this).remove()})}function setCookies(e){2==srv.cookie_level?path=document.location.href:1==srv.cookie_level?path=document.location.pathname:path="/";var r=e.key,t=e.type,a=srv[r].cookie_expire||365;"open"===t?(setCookie("MSopened",r,a,path,void 0,!1),setCookie("MSopened."+r,!0,a,path,void 0,!1)):"sent"===t&&(setCookie("MSFeedbackSent",r,a,path,void 0,!1),setCookie("MSFeedbackSent."+r,!0,a,path,void 0,!1))}function setCookie(e,r,t,a,s,o){var n=new Date;n.setTime(n.getTime()),t&&(t=1e3*t*60*60*24);var i=new Date(n.getTime()+t);document.cookie=e+"="+escape(r)+(t?";expires="+i.toGMTString():"")+(a?";path="+a:"")+(s?";domain="+s:"")+(o?";secure":"")}function getCookie(e){var r,t,a,s=document.cookie.split(";");for(r=0;r<s.length;r++)if(t=s[r].substr(0,s[r].indexOf("=")),a=s[r].substr(s[r].indexOf("=")+1),(t=t.replace(/^\s+|\s+$/g,""))==e)return unescape(a)}function handleIframeWidth(e){var r,t=srv.jQuery(window).width();(e=!(!__MS.isDOM(e)&&!__MS.isDOM(e[0]))&&e)&&(1200<t?r="40%":992<t&&t<1201?r="45%":t<993&&768<t?r="50%":t<769&&544<t?r="70%":t<545&&(r="90%"),e.css({width:r}))}function resizeListener(r,t){var a=function(e){if("number"==typeof e&&srv[t]){srv[t].form_height=e;try{srv.callParentWindow({fn:"srv.resizeForm",data:{height:e,key:t}})}catch(e){}}};srv.jQuery(window).on("orientationchange",function(){setTimeout(function(){var e=document.getElementById(r).parentNode.offsetHeight;a(e)})});var s=setInterval(function(){if(document.getElementById(r)){var e=document.getElementById(r).parentNode.offsetHeight;e!==srv[t].form_height&&a(e)}else clearInterval(s)},10)}function callParentWindow(e,r){r||(r=srv.getParameterByName("parent",document.location.href)||"*"),"function"==typeof window.postMessage&&(isIE&&(e=JSON.stringify(e)),parent.postMessage(e,r))}function callChildWindow(e,r){var t,a;a=r?(t=document.querySelector('[data-key="'+r+'"]')).getAttribute("src"):(t=document.getElementById("surveyWindow")).getAttribute("src"),"function"==typeof window.postMessage&&t&&"IFRAME"===t.nodeName&&(isIE&&(e=JSON.stringify(e)),t.contentWindow.postMessage(e,a))}function initPostMessage(key){var url_match;if(PM_INIT)return!0;if(srv[key].outer_modal){var url_match="https://"+srv[key].domain;PM_INIT=!0}else{var url_match=srv.getParameterByName("parent",document.location.href).split("/");3<url_match.length&&(url_match=url_match[0]+"//"+url_match[2])}var receiveMessage=function(event){if(event.data&&event.origin===url_match)if("object"==typeof event.data){if(event.data.fn){var fn=eval(event.data.fn),data=event.data.data;"function"==typeof fn&&fn(data)}}else try{var parsed=JSON.parse(event.data);if(parsed.fn){var fn=eval(parsed.fn),data=parsed.data;"function"==typeof fn&&fn(data)}}catch(e){var fn=eval(event.data.fn),data=event.data.data;"function"!=typeof fn||"string"!=typeof data&&void 0!==data||fn(data)}};void 0!==window.addEventListener?window.addEventListener("message",receiveMessage,!1):window.attachEvent("onmessage",receiveMessage)}var resizeForm=debounce(function(e){var r=e.key;if(r){var t=srv.jQuery('[data-key="'+r+'"]'),a=t.closest(".surveySliderScroller");if(e.update){if(1==e.update)s=t.outerHeight()+1}else var s=parseInt(e.height,10)+1;var o=function(){return.9*srv.jQuery(window).height()<s};srv[r]&&srv[r].modalFirst?(a.length&&o()?a.css("overflow-y","scroll"):a.length&&a.css("overflow-y","hidden"),t.stop().animate({opacity:1,height:s},{duration:225,complete:function(){srv[r].modalFirst=!1}}),srv[r].form_height=s):srv[r]&&e.height&&!srv[r].modalFirst&&(a.length&&o()?a.css("overflow-y","scroll"):a.length&&a.css("overflow-y","hidden"),t.stop().animate({height:s},{duration:225,complete:function(){srv.log("Srv height set",!1,"info")}}),srv[r].form_height=s)}},100);function getLanguage(e,r){return void 0!==srv[r].survey_text&&void 0!==srv[r].survey_text[e]?srv[r].survey_text[e]:"["+e+"]"}function addButton(e,r){var t=srv[e].button,a=t.content||srv.getLanguage("btnOpenText",e),s=t.style||"tab",o=t.position||"right",n=srv.jQuery("<i>").addClass("fa "+t.icon).css({marginRight:"10px"})||"",i=srv[e].theme_class||"",l=""!=t.icon?"":"no_btn_icon";return"slide"!==srv[e].slider.type?srv.jQuery("<button>").addClass("btn-open-survey btn btn-primary").addClass(s+" "+s+"-"+o+" "+i+" "+l).on("click",function(){srv.openModal(!0,e)}).css("visibility","hidden").css(touch_css).attr("data-button-for",e).html(a).prepend(n):srv.jQuery("<button>").attr({type:"button",id:"openSliderButton","data-button-for":e}).addClass("btn btn-open-slider "+i).html('<i class="fa '+t.icon+'"></i>').on("click",function(){srv[e].modal_open?srv.closeSlider(e):srv.openSlider(!0,e)})}function showButton(e){var r=srv.jQuery("#"+srv[e].div_name);if(e&&!r.find('[data-button-for="'+e+'"]').length){srv.log("Adding feedback button",!1,"info");var t=this.addButton(e);"slide"!==srv[e].slider.type?r.append(t):r.find('[data-button-for="'+e+'"]').length||r.find('[data-key="'+e+'"]').length?r.find('[data-key="'+e+'"]').length&&srv.jQuery('[data-key="'+e+'"]').closest(".surveyWindowWrap").append(t):srv.preloadSlider(e,!1,!0),setTimeout(function(){t.addClass("allow-button")},300)}}function removeButton(e){srv.jQuery("#"+srv[e].div_name+' [data-button-for="'+e+'"]').remove()}function isActive(e,r){var t="select"===r.typeName?r.properties.selected:r.properties.checked;for(var a in t)if("function"!=typeof t[a]&&"function"!=typeof t[a]&&t[a]==e)return!0;return!1}function debounce(a,s,o){var n;return function(){var e=this,r=arguments,t=o&&!n;clearTimeout(n),n=setTimeout(function(){n=null,o||a.apply(e,r)},s),t&&a.apply(e,r)}}function cleanArray(e){var r=[];for(var t in e)"function"!=typeof e[t]&&void 0!==e[t]&&r.push(e[t]);return r}function rand(){return("00000"+(16777216*Math.random()<<0).toString(16)).substr(-6).toUpperCase()}function unsetRequirement(e,r){var t=srv.jQuery("#"+e);t.hasClass("req")&&(t.removeClass("error"),t.parent().removeClass("error"),-1==srv[r].required_when_visible.indexOf(e)&&srv[r].required_when_visible.push(e),delete __MS.errors[__MS.errors.indexOf(e)],__MS.errors=cleanArray(__MS.errors),t.removeClass("req"))}function setRequirement(e,r){var t=srv.jQuery("#"+e);-1<srv[r].required_when_visible.indexOf(e)&&t.addClass("req")}function unhideBlock(r,t){if(-1<r.indexOf("contact_")?($initial_block=srv.jQuery('*[id^="'+r+'"]'),$block=$initial_block.closest(".contact-wrapper"),$block_elements=jQuery('*[id^="contact_'+$block.parent().attr("id")+'"]')):((-1<r.indexOf("matrix_")||-1<r.indexOf("likert_"))&&($block_elements=srv.jQuery('input[type="hidden"][id^="'+r+'"]')),$block=srv.jQuery("#"+r)),$block){if(-1<r.indexOf("section_break"))return $block=srv.jQuery("#"+r.split("_")[2]),void $block.css("display","block");$block.hasClass("contact-wrapper")||$block.hasClass("matrix-group")||$block.hasClass("likert-group")?$block_elements.each(function(e,r){setRequirement(r.id,t)}):setRequirement(r,t);try{$block.parent().css("display","block")}catch(e){srv.log("block:"+r+" not found")}}}function hideBlock(e,a,s,o){if("function"!=typeof e&&(-1<e.indexOf("contact_")?($initial_block=srv.jQuery('*[id^="'+e+'"]'),$block=$initial_block.closest(".contact-wrapper"),$block_elements=jQuery('*[id^="contact_'+$block.parent().attr("id")+'"]')):((-1<e.indexOf("matrix_")||-1<e.indexOf("likert_"))&&($block_elements=srv.jQuery('input[type="hidden"][id^="'+e+'"]')),$block=srv.jQuery("#"+e)),$block))if(-1<e.indexOf("section_break"))$block=srv.jQuery("#"+e.split("_")[2]),$block.css("display","none");else{var r=$block.parent();r.css("display","none"),r.removeClass("error"),$block.removeClass("error"),$block.hasClass("contact-wrapper")||$block.hasClass("matrix-group")||$block.hasClass("likert-group")?$block_elements.each(function(e,r){if(unsetRequirement(r.id,o),a){var t=srv.jQuery(r);t.not(":checkbox,:radio").val(""),t.prop("checked",!1),t.is("select")&&srv.niceSelect(t,"update",o),s&&t.trigger(s)}}):(unsetRequirement(e,o),a&&(r.find("input").not(":checkbox,:radio").val(""),r.find("input").prop("checked",!1),r.find(".ui-stars-star").removeClass("ui-stars-star-on"),"select"==e.split("_")[0]&&($block.val(""),srv.niceSelect($block,"update",o)),s&&$block.trigger(s)))}}function setPrefill(r,t,e,a){var s;($block=srv.jQuery("#"+r),$block)&&(null!==r.match(/section_break/gi)&&(r=r.replace("section_break","section_description")),"url_query"==e?s=getParameterByName(t,LOCATION_REF):"cookie"==e?s=getCookie(t):"url"==e?(-1<document.referrer.indexOf(t)||-1<LOCATION_REF.indexOf(t))&&("show"===a?srv.jQuery("#"+r).closest(".control-group").show():srv.jQuery("#"+r).closest(".control-group").hide()):"title"==e?setTimeout(function(){var e=jQuery("[data-key]").attr("data-key");-1<srv[e].document_title.indexOf(t)&&("show"===a?srv.jQuery("#"+r).closest(".control-group").show():srv.jQuery("#"+r).closest(".control-group").hide())}):e&&"fixed"!=e||(s=key),$block.val(decodeURIComponent(s)),""!==$block.val()&&$block.trigger("blur"))}function setNextPage(e,r){for(var t in srv[r].next_page=parseInt(e),srv[r].page_history)t==e||srv[r].page_history[t]==srv[r].current_page&&delete srv[r].page_history[t]}function showError(e,r){e instanceof jQuery==0&&(e=srv.jQuery(e));var t=e.closest("[data-key]").attr("data-key"),a=e.parent(),s=e.attr("id");if("TR"==a[0].nodeName){var o=s.split("_"),n=o[0]+"_"+o[1];a=srv.jQuery("#"+n),s=n;r.code="required_multi",__MS.unsetError(e),r.state?__MS.unsetError(a):__MS.setError(a)}else if(e.parents(".contact-wrapper")[0])a=e.parent();if(srv.jQuery("#"+s+"_error")[0]&&srv.jQuery("#"+s+"_error").remove(),!r.state&&-1!=__MS.errors.indexOf(s)){var i=srv.jQuery("<div>").attr("id",s+"_error").addClass("alert alert-danger").html(r.code&&srv[t].error_messages[r.code]?srv[t].error_messages[r.code]:srv[t].error_messages.deflt);a.append(i)}}function postSubmit(e,r){srv.nextPage(-1,r);getParameterByName("parent",document.location.href);if(e.to){var t={surveyKey:r,email:e.to};srv.request("notify-user",t,function(e){srv.log(e)},function(){srv.log("Failed to send notification",!0,"error")},!0,r)}var a=srv.jQuery('[data-key="'+r+'"]');if(0<e.timeout&&!srv.jQuery(window.frameElement).hasClass("preview_embed")){var s=e.timeout;a.find("#countdown").html(e.timeout/1e3);var o=setInterval(function(){s-=1e3,a.find("#countdown").html(s/1e3),s<=0&&(clearInterval(o),srv.callParentWindow({fn:"srv.closeModal",data:r}))},1e3)}else a.find("#autoClose").remove()}function getParameterByName(e,r){e=e.replace(/[\[]/,"[").replace(/[\]]/,"]");var t=new RegExp("[?&]"+e+"=([^&#]*)").exec(r);return null==t?"":decodeURIComponent(t[1].replace(/\+/g," "))}function setLikert(e){var r=srv.jQuery("#"+e.name);r.val(e.value),showError(r,{state:!0}),__MS.unsetError(r)}function setMatrix(e){var r=e.name.split("_"),t=srv.jQuery('input[name="'+r[0]+"_"+r[1]+"_"+r[2]+'_value"]:checked').val(),a=srv.jQuery('input[name="'+r[0]+"_"+r[1]+"_"+r[2]+'_weight"]:checked').val(),s=srv.jQuery("#"+r[0]+"_"+r[1]+"_"+r[2]);if(t&&a){var o=JSON.stringify({value:t,weights:a});s.val(o),showError(s,{state:!0}),__MS.unsetError(s)}}function initCapture(l){var i;if(!(l=l||{}).embedded){srv.jQuery("html,body").removeClass("mopinion-modal-active");var e=srv.jQuery('[data-key="'+l.key+'"]');e.addClass("screen-capture-active"),e.closest(".surveyWindowWrap").addClass("screen-capture-active"),srv.jQuery("#surveyMask").addClass("screen-capture-active")}function d(e,r){if(srv.jQuery("#mopinion_dimmer_overlay").remove(),e)var t=e[0].getBoundingClientRect();var a=srv.jQuery("<div>").attr({id:"mopinion_dimmer_overlay","data-dimmer-for":l.key}).addClass(srv[l.key].theme_class||"");l.embedded&&a.addClass("is-embedded");srv.jQuery("<div>").addClass("dimmer-border").appendTo(a);var s=srv.jQuery("<div>").addClass("dimmer-actions").appendTo(a);srv.jQuery("<div>").html(r?'<i class="fa fa-check" style="margin-right:10px"></i>'+srv.getLanguage("screenCaptureSelected",l.key):(user_touching?'<i class="fa fa-hand-pointer-o" style="margin-right:10px"></i>':'<i class="fa fa-mouse-pointer" style="margin-right:10px"></i>')+srv.getLanguage("screenCaptureText",l.key)).appendTo(s),srv.jQuery("<div>").html("&times;").addClass("dimmer-cancel").on("click",function(e){e.stopPropagation(),setTimeout(function(){srv.clearCaptureEvents(l.key),l.embedded?srv.clearCaptureValues({block_id:l.block_id,key:l.key}):(srv.showModalPostCapture(l.key),srv.callChildWindow({fn:"srv.clearCaptureValues",data:{block_id:l.block_id,key:l.key}},l.key))})}).appendTo(s);if(e){if(!l.embedded&&!0===l.supportsPointerEvents)srv.jQuery("<div>").css({position:"fixed",background:"rgba(0,0,0,.3)",top:0,height:t.top,left:0,right:0,pointerEvents:"none"}).appendTo(a),srv.jQuery("<div>").css({position:"fixed",background:"rgba(0,0,0,.3)",top:t.bottom,bottom:0,left:0,right:0,pointerEvents:"none"}).appendTo(a),srv.jQuery("<div>").css({position:"fixed",background:"rgba(0,0,0,.3)",top:t.top,height:t.height,left:0,width:t.left,pointerEvents:"none"}).appendTo(a),srv.jQuery("<div>").css({position:"fixed",background:"rgba(0,0,0,.3)",top:t.top,height:t.height,width:srv.jQuery(window).width()-t.right,right:0,pointerEvents:"none"}).appendTo(a);var o=srv.jQuery("<div>").addClass("dimmer-highlight").css({position:"fixed",top:t.top-3,left:t.left-3,height:t.height+6,width:t.width+6}).appendTo(a);if(user_touching&&!r)srv.jQuery("<button>").attr({type:"button"}).text(srv.getLanguage("screenCaptureTouchBtnText",l.key)).addClass("btn-select-touch").on("click",function(e){e.preventDefault(),e.stopPropagation(),srv.jQuery(this).trigger("click.mopinion_screencapture",{selected:!0})}).appendTo(o);r&&o.addClass("dimmer-selected"),srv.jQuery("body").append(a)}else{srv.jQuery("<div>").css({position:"fixed",background:"rgba(0,0,0,.3)",top:0,bottom:0,left:0,right:0,pointerEvents:"none"}).appendTo(a);var n=srv.jQuery("<div>").addClass("capture-hint").appendTo(a),i=srv.jQuery("<i>").appendTo(n);user_touching?i.addClass("fa fa-hand-pointer-o"):i.addClass("fa fa-mouse-pointer");srv.jQuery("<div>").text(srv.getLanguage("screenCaptureHint",l.key)).appendTo(n);srv.jQuery("body").append(a)}}setTimeout(function(){srv.jQuery(document).on("mousemove.mopinion_screencapture",function(e){user_touching||d(srv.jQuery(e.target))}),srv.jQuery("*").on("click.mopinion_screencapture",function(e,r){if(e.preventDefault(),e.stopPropagation(),srv.jQuery(document).off("mousemove.mopinion_screencapture"),r||(i=e.target),srv.jQuery(window).off("scroll.mopinion_screencapture").on("scroll.mopinion_screencapture",function(e){!user_touching||r?d(srv.jQuery(i),!0):d(srv.jQuery(i))}),!user_touching||r&&r.selected){srv.jQuery("#mopinion_dimmer_overlay").remove(),srv.jQuery("[data-mopinion-screen-capture]").removeAttr("data-mopinion-screen-capture");var t=(s=i,o=srv.jQuery(s).clone(),n=["[data-mop-supress]"],l.maskedSelectors.length&&(n=n.concat(l.maskedSelectors)),n.forEach(function(e){if(o.is(e))o.html("***");else try{o.find(e).html("***")}catch(e){}}),o.find("input").each(function(e,r){var t=srv.jQuery(r);try{t.attr("value","***")}catch(e){}try{t.attr("checked",!1)}catch(e){}}),o.find("select").each(function(e,r){var t=srv.jQuery(r);try{t.find("option:selected").removeAttr("selected")}catch(e){}}),o.find("textarea").each(function(e){srv.jQuery(e).text("***")}),srv.jQuery.trim(o.prop("outerHTML")).replace(/(\r\n|\n|\r)/gm," "));srv.jQuery(i).attr("data-mopinion-screen-capture","");var a=function(){var r=srv.jQuery("html").clone(),e=["[data-mop-supress]"];l.maskedSelectors.length&&(e=e.concat(l.maskedSelectors)),r.find("input").each(function(e,r){var t=srv.jQuery(r);try{t.attr("value","***")}catch(e){}try{t.attr("checked",!1)}catch(e){}try{t.attr("data-mopinion-mask-input","")}catch(e){}}),r.find("select").each(function(e,r){var t=srv.jQuery(r);try{t.attr("data-mopinion-mask-input","")}catch(e){}try{t.find("option:selected").removeAttr("selected")}catch(e){}}),r.find("textarea").each(function(e){var r=srv.jQuery(e);try{r.text("***").attr("data-mopinion-mask-input")}catch(e){}}),e.forEach(function(e){try{r.find(e).attr("data-mopinion-mask-extra","")}catch(e){}});var t=srv.jQuery("<base>").attr("href",location.origin);if(r.find("head").find("base").length){if(r.find("head").find("base").length){var a=r.find("head").find("base").attr("href"),s=srv.jQuery("<base>");if(-1===a.indexOf(location.origin)){var o="/"===a.charAt(0)?location.origin+a:location.origin+"/"+a;s.attr("href",o)}else s.attr("href",a);r.find("head").find("base").remove(),r.find("head").prepend(s)}}else r.find("head").prepend(t);return srv.jQuery.trim(r.prop("outerHTML")).replace(/(\r\n|\n|\r)/gm," ")}();d(srv.jQuery(i),!0),srv.jQuery("*").off("click.mopinion_screencapture"),l.embedded?srv.catchCapture({dom:a,selector:t,block_id:l.block_id,key:l.key}):srv.callChildWindow({fn:"srv.catchCapture",data:{dom:a,selector:t,block_id:l.block_id,key:l.key}},l.key)}else d(srv.jQuery(i));var s,o,n})},150),d()}function clearCaptureEvents(e){setTimeout(function(){srv.jQuery("#mopinion_dimmer_overlay").remove(),srv.jQuery("*").off("click.mopinion_screencapture"),srv.jQuery(document).off("mousemove.mopinion_screencapture"),srv.jQuery(window).off("scroll.mopinion_screencapture"),srv.jQuery("[data-mopinion-screen-capture]").removeAttr("data-mopinion-screen-capture")})}function clearCaptureValues(e){srv.jQuery("#screenshot_"+e.block_id).val("").trigger("change"),srv.jQuery("#dom_"+e.block_id).val(""),srv.jQuery("#selector_"+e.block_id).val(""),srv.jQuery("#"+e.block_id).removeClass("screen-captured"),__MS.validateField(srv.jQuery("#screenshot_"+e.block_id)[0])}function toHTMLEntities(e){return e.replace(/./gm,function(e){return"&#"+e.charCodeAt(0)+";"})}function fromHTMLEntities(e){return(e+"").replace(/&#\d+;/gm,function(e){return String.fromCharCode(e.match(/\d+/gm)[0])})}function catchCapture(e){e=e||{},srv.log("Screen capture caught for block :"+e.block_id);var r=fromHTMLEntities(e.selector),t=encodeQuotes(e.dom);srv.jQuery("#selector_"+e.block_id).val(r),srv.jQuery("#dom_"+e.block_id).val(t),srv.jQuery("#screenshot_"+e.block_id).val("https://mopinion-visual-feedback.s3-eu-west-1.amazonaws.com/camera-icon.png").trigger("change"),__MS.validateField(srv.jQuery("#screenshot_"+e.block_id)[0]),e.embedded||srv.callParentWindow({fn:"srv.showModalPostCapture",data:e.key}),0<r.length&&0<t.length?srv.jQuery("#"+e.block_id).addClass("screen-captured"):srv.jQuery("#"+e.block_id).removeClass("screen-captured")}function showModalPostCapture(e){"slide"!==srv[e].slider.type?srv.jQuery("html,body").addClass("mopinion-modal-active"):srv.jQuery("html,body").addClass("mopinion-slider-active");var r=srv.jQuery('[data-key="'+e+'"]');r.removeClass("screen-capture-active"),r.closest(".surveyWindowWrap").removeClass("screen-capture-active"),srv.jQuery("#surveyMask").removeClass("screen-capture-active")}function userIdle(r,t){idleTimer=null,idleState=!1,srv.jQuery("*").bind("mousemove keydown scroll",function(e){clearTimeout(idleTimer),idleState,idleState=!1,idleTimer=setTimeout(function(){srv.log("You've been idle for "+r/1e3+" seconds.");var e=new Function(t+"()");srv[key].modal_open||srv[key].modal_dismissed||e(),idleState=!0},r)}),srv.jQuery("body").trigger("mousemove")}function userExit(e,r){var t=!1,a=new Function(r+"()");srv.jQuery(document).bind("mouseout",function(e){if(e=e||window.event,mouseFrom=e.relatedTarget||e.toElement,!mouseFrom||"HTML"==mouseFrom.nodeName)var r=e.pageY<100;modal_open||modal_dismissed||!t||r&&(t=!1,a())}),setTimeout(function(){t=!0},e)}function proActiveOpen(e,r){var t=new Function(r+"()");setTimeout(function(){modal_open||modal_dismissed?srv.log("already opened or dismissed"):t()},e)}function triggerForUrl(e,r){var t=document.location.href,a=!!r;for(var s in e=JSON.parse(e)||{})if("function"!=typeof e[s]){var o=e[s];if("function"!=typeof o){var n=new RegExp(o,"g");t.match(n)&&(a=!r)}}return a}function scrollToFormPos(e){var r=e.position,t=e.key,a=srv.jQuery('[data-key="'+t+'"]'),s="slide"!==srv[t].slider.type?a.closest(".surveyWindowWrap"):a.closest(".surveySliderScroller");"IFRAME"===!a[0].nodeName&&(s=srv.jQuery("html, body"),r=0==r?a.offset().top:r),setTimeout(function(){s.animate({scrollTop:r},225)},50)}function enableNext(e){if(void 0!==srv[e].survey_properties&&0==srv[e].survey_properties.advanced.next_button_behaviour||void 0===srv[e].required_map)return!1;var r=srv[e].required_map[srv[e].current_page];all_filled=!0,srv.jQuery(r).each(function(e,r){var t=srv.jQuery("#"+r);t&&(void 0===t.val()||""==srv.jQuery.trim(t.val()))&&srv.jQuery(t).parent().is(":visible")&&(all_filled=!1)});var t=srv.jQuery('[data-key="'+e+'"]').find("#page"+srv[e].current_page),a=t.find("#surveySubmitBtn")[0]?t.find("#surveySubmitBtn"):t.find(".btn-next");"disable"==srv[e].survey_properties.advanced.next_button_behaviour?a.prop("disabled",!all_filled):"hide"==srv[e].survey_properties.advanced.next_button_behaviour&&a.toggle(all_filled)}function scrollToSurveyElement(e,r){window!=window.top?srv.callParentWindow({fn:"srv.scrollToFormPos",data:{position:e,key:r}}):scrollToFormPos({position:e,key:r})}function transitionEnd(){var e,r,t=document.createElement("div"),a={transition:"transitionend",OTransition:"oTransitionEnd",MozTransition:"transitionend",WebkitTransition:"webkitTransitionEnd"};for(e in a)if(void 0!==t.style[e]){r=a[e];break}return void 0!==r?r:"notransition"}function setLock(e){srv[e].lock_submit=!0,srv.jQuery('[data-key="'+e+'"]').find(".btn-next, .btn-submit").prop("disabled",!0)}function clearLock(e){srv[e].lock_submit=!1,srv.jQuery('[data-key="'+e+'"]').find(".btn-next, .btn-submit").prop("disabled",!1)}function makeStars(e,i){var l,r=e.find('input[type="radio"]'),d=(i=i||{}).hidden||srv.jQuery("#"+i.type+"_"+i.block_id),c=document.createDocumentFragment(),u=!1;i.showCaptions&&(u=srv.jQuery("<span>").addClass("caption")),r.each(function(e,r){var t=srv.jQuery(r),a=t.val(),s=t.attr("title"),o=e+1,n=srv.jQuery("<div>").attr("data-value",a).attr("data-title",s).addClass("ui-stars-star").addClass("star_"+o).on("mouseenter",function(){srv.jQuery(this).removeClass("ui-stars-star-on").siblings(".ui-stars-star").removeClass("ui-stars-star-on"),srv.jQuery(this).addClass("ui-stars-star-hover").prevAll(".ui-stars-star").addClass("ui-stars-star-hover"),u&&u.text(srv.jQuery(this).attr("data-title"))}).on("mouseleave",function(){srv.jQuery(this).removeClass("ui-stars-star-hover").prevAll(".ui-stars-star").removeClass("ui-stars-star-hover"),l&&l.addClass("ui-stars-star-on").prevAll(".ui-stars-star").addClass("ui-stars-star-on"),u&&!l?u.text(""):u&&l&&u.text(l.attr("data-title"))}).on("click",function(){var e=srv.jQuery(this).attr("data-value");if(d.val(e).trigger("change"),l=srv.jQuery(this),srv.jQuery(this).siblings(".ui-stars-star").removeClass("ui-stars-star-on ui-stars-star-hover"),srv.jQuery(this).addClass("ui-stars-star-on").prevAll(".ui-stars-star").addClass("ui-stars-star-on"),i.callback&&"function"==typeof i.callback){var r=i.callback_data||"";i.callback(r)}}).appendTo(c);srv.jQuery("<a>").text(a).appendTo(n);t.remove()}),u&&u.appendTo(c),e.append(c)}function niceSelect(e,r,t){var a=srv.jQuery("#"+this[t].div_name);function s(e){e.after(srv.jQuery("<div></div>").addClass("nice-select").addClass(e.attr("class")||"").addClass(e.attr("disabled")?"disabled":"").attr("tabindex",e.attr("disabled")?null:"0").html('<span class="current"></span><ul class="list"></ul>'));var a=e.next(),r=e.find("option"),t=e.find("option:selected");a.find(".current").html(t.data("display")||t.text()),r.each(function(e){var r=srv.jQuery(this),t=r.data("display");a.find("ul").append(srv.jQuery("<li></li>").attr("data-value",r.val()).attr("data-display",t||null).addClass("option"+(r.is(":selected")?" selected":"")+(r.is(":disabled")?" disabled":"")).html(r.text()))})}"string"!=typeof r?(e.each(function(){var e=srv.jQuery(this);e.hide(),e.next().hasClass("nice-select")||s(e)}),a.off(".nice_select"),a.on("click.nice_select",".nice-select",function(e){var r=srv.jQuery(this);if(srv.jQuery(".nice-select").not(r).removeClass("open"),r.toggleClass("open"),r.hasClass("open")){r.find(".option"),r.find(".focus").removeClass("focus"),r.find(".selected").addClass("focus");var t=srv.jQuery(window).height(),a=r.offset().top+r.outerHeight();t-a<250?r.find(".list").css({maxHeight:t-a-10}):r.find(".list").css({maxHeight:""})}else r.focus()}),a.on("click.nice_select",function(e){0===srv.jQuery(e.target).closest(".nice-select").length&&srv.jQuery(".nice-select").removeClass("open").find(".option")}),a.on("click.nice_select",".nice-select .option:not(.disabled)",function(e){var r=srv.jQuery(this),t=r.closest(".nice-select");t.find(".selected").removeClass("selected"),r.addClass("selected");var a=r.data("display")||r.text();t.find(".current").text(a),t.prev("select").val(r.data("value")).trigger("change")}),a.on("keydown.nice_select",".nice-select",function(e){var r=srv.jQuery(this),t=srv.jQuery(r.find(".focus")||r.find(".list .option.selected"));if(32==e.keyCode||13==e.keyCode)return r.hasClass("open")?t.trigger("click"):r.trigger("click"),!1;if(40==e.keyCode){if(r.hasClass("open")){var a=t.nextAll(".option:not(.disabled)").first();0<a.length&&(r.find(".focus").removeClass("focus"),a.addClass("focus"))}else r.trigger("click");return!1}if(38==e.keyCode){if(r.hasClass("open")){var s=t.prevAll(".option:not(.disabled)").first();0<s.length&&(r.find(".focus").removeClass("focus"),s.addClass("focus"))}else r.trigger("click");return!1}if(27==e.keyCode)r.hasClass("open")&&r.trigger("click");else if(9==e.keyCode&&r.hasClass("open"))return!1})):"update"==r?e.each(function(){var e=srv.jQuery(this),r=srv.jQuery(this).next(".nice-select"),t=r.hasClass("open");r.length&&(r.remove(),s(e),t&&e.next().trigger("click"))}):"destroy"==r?(e.each(function(){var e=srv.jQuery(this),r=srv.jQuery(this).next(".nice-select");r.length&&(r.remove(),e.css("display",""))}),0==srv.jQuery(".nice-select").length&&a.off(".nice_select")):console.log('Method "'+r+'" does not exist.')}function getMeta(e){var r=e.key;if(e.passback)return srv[r].window_viewport=e.viewport,srv[r].document_title=e.title,srv[r].trigger_method=e.trigger_method,void(srv[r].ga_id=e.ga_id);if(srv[r].outer_modal){srv[r].window_viewport=srv.jQuery(window).width()+"x"+srv.jQuery(window).height(),srv[r].document_title=document.title||"";try{srv[r].ga_id=ga.getAll()[0].get("trackingId")}catch(e){}}else srv.callParentWindow({fn:"srv.returnMeta",data:{key:r}})}function returnMeta(e){var r=e.key||"",t=srv.jQuery(window).width()+"x"+srv.jQuery(window).height(),a="";try{a=ga.getAll()[0].get("trackingId")}catch(e){}srv.callChildWindow({fn:"srv.getMeta",data:{viewport:t,title:document.title,trigger_method:srv[r].trigger_method||"",key:r,ga_id:a,passback:!0}},r)}function supportsPointerEvents(e){var r=document.createElement("a").style;return r.cssText="pointer-events:auto","auto"===r.pointerEvents||(e&&srv.jQuery("html").addClass("no-csspointerevents"),!1)}function supportsSvg(){return document.implementation.hasFeature("http://www.w3.org/TR/SVG11/feature#Image","1.1")}function encodeQuotes(e){var r={'"':"&quot;","'":"&#039;"};return e.replace(/["']/g,function(e){return r[e]})}function iOSTest(e){var r=parseFloat((""+(/CPU.*OS ([0-9_]{1,5})|(CPU like).*AppleWebKit.*Mobile/i.exec(navigator.userAgent)||[0,""])[1]).replace("undefined","3_2").replace("_",".").replace("_",""))||!1;return e?"fixed_positioning"===e?!(!r||r&&/CriOS/i.test(navigator.userAgent))&&r<10.3:"scroll_on_input"===e?10.2<r:void 0:r}function fetchVariable(obj){if("string"==typeof obj&&(obj=decodeURIComponent(obj)),"object"!=typeof obj)try{obj=JSON.parse(obj)}catch(e){}var key=obj.key,type=obj.type,value=obj.value,hidden_id=obj.hidden_id;srv.log("Fetching "+type+" data from :"+value,"info");var passback="";if("css_selector"===type){var $selector;try{$selector=srv.jQuery(value.replace(/"/g,"'"))}catch(e){}$selector&&(passback="INPUT"===$selector.prop("nodeName")||"TEXTAREA"===$selector.prop("nodeName")?$selector.val():srv.jQuery.trim($selector.text()))}else if("js"===type){var js_var;try{js_var=eval(value)}catch(e){}if(void 0!==js_var){if("object"==typeof js_var)try{js_var=JSON.stringify(js_var)}catch(e){}"string"!=typeof js_var&&"number"!=typeof js_var||(passback=js_var)}}else if("cookie"===type){var cookie_val=getCookie(value);cookie_val&&"string"==typeof cookie_val&&(passback=cookie_val)}else if("url_parameter"===type){var url_param=getParameterByName(value,LOCATION_REF);url_param&&"string"==typeof url_param&&(passback=url_param)}if(passback)if(srv.log("Data found from "+type+": "+value,"info"),obj.embedded)if(srv.jQuery("#"+hidden_id).length)srv.jQuery("#"+hidden_id).val(passback);else var poll=setInterval(function(){srv.jQuery("#"+hidden_id).length&&(clearInterval(poll),srv.jQuery("#"+hidden_id).val(passback))},50);else srv.callChildWindow({fn:"(function(obj) {srv.jQuery('#'+obj.hidden_id).val(obj.data)})",data:{hidden_id:hidden_id,data:passback}},key);else srv.log("No data found from "+type+": "+value,"info")}function preloadSlider(t,e,r){if(srv.jQuery('[data-key="'+t+'"]').length&&!srv[t].is_loading)return"open"===e&&srv.openSlider(!0,t),!0;if(!srv[t].is_loading){var a=srv.jQuery("#"+srv[t].div_name),s=srv.jQuery("<div>").attr({id:"surveyWindowWrap","data-parent-for":t}).addClass("surveyWindowWrap").css({position:"fixed",zIndex:2000000001,"backface-visibility":"hidden"}).addClass("mopinion-slider slide-"+srv[t].slider.position),o="https://"+srv[t].domain+"/survey/public/modal?&key="+t+"&domain="+srv[t].domain+"&version="+srv[t].version+"&parent="+document.location,n=srv.jQuery("<div>").attr("id","surveySliderScroller").addClass("surveySliderScroller").css({maxHeight:"90vh",overflowY:"hidden","-ms-overflow-style":"-ms-autohiding-scrollbar","-webkit-overflow-scrolling":"touch"}).appendTo(s),i=(srv.jQuery("<iframe>").attr("id","surveyWindow").attr("src",o).attr("frameBorder",!1).attr("allowTransparency",!0).attr("data-key",t).addClass("surveyWindow").css({border:"none",borderRadius:"2px",width:"100%",background:"rgba(255,255,255,0.01)"}).appendTo(n),{});if("right"===srv[t].slider.position?i={top:"10%",top:"calc(10% + 5px)",bottom:"auto",left:"auto",right:0,transform:"translateX(100%)"}:"bottom-right"===srv[t].slider.position?i={top:"auto",bottom:"-5px",left:"auto",right:"2.5%",transform:"translateY(100%)"}:"bottom-left"===srv[t].slider.position?i={top:"auto",bottom:"-5px",left:"2.5%",right:"auto",transform:"translateY(100%)"}:"left"===srv[t].slider.position&&(i={top:"10%",top:"calc(10% + 5px)",left:0,right:"auto",transform:"translateX(-100%)"}),r||srv[t].show_button){var l=srv.addButton(t);l.appendTo(s),setTimeout(function(){l.addClass("allow-button")},300)}return s.css(i).appendTo(a),sliderWidth(s),srv.jQuery(window).on("resize orientationchange",function(){sliderWidth(s)}),"open"===e&&srv.jQuery(document).on("mopinion_loaded",function e(r){r.detail.key===t&&r.detail.iframe&&(srv.openSlider(!0,t),srv.jQuery(document).off("mopinion_loaded",e))}),!0}}function openSlider(e,r){if(!r){if(1!==ALL_KEYS.length){try{srv.log("Key needed when multiple forms are initialized",!0,"warn")}catch(e){}return}r=ALL_KEYS[0]}if(getCookie("MSopened")==r&&!e||srv[r].modal_open){var t="Not opening, reason: ";srv[r].modal_open?t+="Already open":getCookie("MSopened")==r&&(t+="Got a cookie, and not forced by user"),isPreview&&srv.jQuery("#surveyPreviewMessageContent").html(t),srv.log(t)}else{e&&srv.log("User forced opening of modal",!1,"info");var a=srv.jQuery('[data-key="'+r+'"]'),s=a.closest(".surveyWindowWrap");if(!a.length)return void srv.preloadSlider(r,"open");srv[r].modalFirst=!0,animateTranslate(s,{from:-1<["right","bottom-left","bottom-right"].indexOf(srv[r].slider.position)?"100":"-100",to:"0",type:-1<["left","right"].indexOf(srv[r].slider.position)?"x":"y"},function(){srv.jQuery("html,body").addClass("mopinion-slider-active"),srv[r].modal_open=!0,srv.triggerEvent({event:"shown",key:r}),setCookies({type:"open",key:r})})}return!0}function closeSlider(e){if(srv[e].modal_open){var r=srv.jQuery('[data-key="'+e+'"]').closest(".surveyWindowWrap");srv.clearCaptureEvents(e),animateTranslate(r,{to:-1<["right","bottom-left","bottom-right"].indexOf(srv[e].slider.position)?"100":"-100",type:-1<["left","right"].indexOf(srv[e].slider.position)?"x":"y"},function(){srv[e].modalFirst=!1;var t=srv[e].modal_open=!1;srv.jQuery.each(srv.ALL_KEYS,function(e,r){srv[r].modal_open&&(t=!0)}),t||srv.jQuery("html,body").removeClass("mopinion-slider-active"),srv.triggerEvent({event:"hidden",key:e})})}}function sliderWidth(e){var r=srv.jQuery(window).width();$iframe=!(!__MS.isDOM(e)&&!__MS.isDOM(e[0]))&&e,$iframe&&(1200<r?frameWidth="425px":992<r&&r<1201?frameWidth="380px":r<993&&768<r?frameWidth="380px":r<769&&544<r?frameWidth="320px":r<545&&(frameWidth="260px"),$iframe.css({width:frameWidth}))}function animateTranslate(t,e,r){if(t&&"object"==typeof e){var a="y"!=e.type?"translateX":"translateY",s=e.unit?e.unit:"%",o=e.from||0;srv.jQuery({noop:o}).animate({noop:e.to},{duration:e.duration||225,step:function(e,r){t.css("transform",a+"("+e+s+")")},complete:r||!1})}}function clearForm(e){var r=srv.jQuery('[data-key="'+e+'"]'),t=r.closest(".surveyWindowWrap"),a=srv.jQuery('[data-button-for="'+e+'"]');return r.remove(),t.remove(),a.remove(),srv.jQuery("#SRVvars"+e).remove(),-1<ALL_KEYS.indexOf(e)&&ALL_KEYS.splice(ALL_KEYS.indexOf(e),1),delete srv[e],srv.log("Form "+e+" cleared."),!0}function getPreselectValue(e,r){return!!r&&srv.getParameterByName(e,LOCATION_REF)}function loadWebFonts(e,r){if("string"==typeof e&&(e=[].concat(e)),e instanceof Array){var t=srv.jQuery.map(e,function(e){if(e&&!fontIsLoaded(e))return e});if(t.length){var a=srv.jQuery.map(t,function(e){return e.replace(/ /g,"+")}).join("|");srv.log("Loading fonts: "+t.join(", "),!1,"info");var s="https://fonts.mopinion.com/css?family="+a;srv.appendStyle(s,"CUSTOMSRVFONTS"+r)}}}function fontIsLoaded(e){if(document.fonts&&"function"==typeof document.fonts.check&&window.chrome)return document.fonts.check("12px "+e);var r=document.createElement("span");r.innerHTML="giItT1WQy@!-/#",r.style.position="absolute",r.style.left="-10000px",r.style.top="-10000px",r.style.fontSize="300px",r.style.fontFamily="sans-serif",r.style.fontVariant="normal",r.style.fontStyle="normal",r.style.fontWeight="normal",r.style.letterSpacing="0",document.body.appendChild(r);var t=r.offsetWidth;r.style.fontFamily=e+", sans-serif";var a=r.offsetWidth!==t;return r.parentNode.removeChild(r),a}function addAnalytics(e,r){var t,a,s,o,n,i=e.GA_TRACKING_ID||srv[r].ga_id||"";!e.TYPE&&e.load_analytics&&i?(srv.appendScript("https://www.googletagmanager.com/gtag/js?id="+i),window.dataLayer=window.dataLayer||[],window.gtag=function(){dataLayer.push(arguments)},gtag("js",new Date),gtag("config",i)):"analytics.js"===e.TYPE&&e.load_analytics&&i&&(t=window,a=document,s="ga",t.GoogleAnalyticsObject=s,t.ga=t.ga||function(){(t.ga.q=t.ga.q||[]).push(arguments)},t.ga.l=1*new Date,o=a.createElement("script"),n=a.getElementsByTagName("script")[0],o.async=1,o.src="https://www.google-analytics.com/analytics.js",n.parentNode.insertBefore(o,n),ga("create",i,"auto"),ga("send","pageview"))}var Sobject={};Sobject.resizeListener=resizeListener,Sobject.callParentWindow=callParentWindow,Sobject.callChildWindow=callChildWindow,Sobject.resizeForm=resizeForm,Sobject.send=send,Sobject.appendScript=appendScript,Sobject.appendStyle=appendStyle,Sobject.loadHelpers=loadHelpers,Sobject.loadSurvey=loadSurvey,Sobject.loadJSON=loadJSON,Sobject.buildForm=buildForm,Sobject.generateHTML=generateHTML,Sobject.log=log,Sobject.prevPage=prevPage,Sobject.nextPage=nextPage,Sobject.setValue=setValue,Sobject.submitSurvey=submitSurvey,Sobject.openModal=openModal,Sobject.closeModal=closeModal,Sobject.hideLoader=hideLoader,Sobject.request=request,Sobject.updateProgress=updateProgress,Sobject.getLanguage=getLanguage,Sobject.removeButton=removeButton,Sobject.addButton=addButton,Sobject.showButton=showButton,Sobject.getParameterByName=getParameterByName,Sobject.makeStars=makeStars,Sobject.niceSelect=niceSelect,Sobject.setCookie=setCookie,Sobject.getCookie=getCookie,Sobject.setCookies=setCookies,Sobject.triggerEvent=triggerEvent,Sobject.on=EventHandler,Sobject.initEvent=EventInitializer,Sobject.loadjQuery=loadjQuery,Sobject.loadjQueryHandler=loadjQueryHandler,Sobject.proActiveOpen=proActiveOpen,Sobject.userExit=userExit,Sobject.triggerForUrl=triggerForUrl,Sobject.setPrefill=setPrefill,Sobject.hideBlock=hideBlock,Sobject.unhideBlock=unhideBlock,Sobject.scrollToFormPos=scrollToFormPos,Sobject.initCapture=initCapture,Sobject.catchCapture=catchCapture,Sobject.showModalPostCapture=showModalPostCapture,Sobject.clearCaptureEvents=clearCaptureEvents,Sobject.clearCaptureValues=clearCaptureValues,Sobject.getMeta=getMeta,Sobject.returnMeta=returnMeta,Sobject.fetchVariable=fetchVariable,Sobject.open=opener,Sobject.clearForm=clearForm,Sobject.loadWebFonts=loadWebFonts,Sobject.preloadSlider=preloadSlider,Sobject.openSlider=openSlider,Sobject.closeSlider=closeSlider,Sobject.sliderWidth=sliderWidth,Sobject.show_log=show_log,Sobject.ALL_KEYS=ALL_KEYS,Sobject.PUBLIC_LANDING=PUBLIC_LANDING,Sobject.LOCATION_REF=LOCATION_REF,Sobject.eventsHandlers=eventsHandlers;try{srv.log("loading Surveys "+version,!1,"info")}catch(e){}return Sobject}(),mopinion=srv,__MS=function(){MSobject={};var h=new RegExp(/^len[0-9]+/),_=new RegExp(/^max_len[0-9]+/),g=(new RegExp(/^(((0)[1-9]{2}[0-9][-]?[1-9][0-9]{5})|((\+31|0|0031)[1-9][0-9][-]?[1-9][0-9]{6}))|((\\+31|0|0031)6){1}[-]?[1-9]{1}[0-9]{7}$/),new RegExp(/^[1-9][0-9]{3}[\s]?[A-Za-z]{2}$/i),new RegExp(/^(\+){0,1}[0-9-.\(\)]{6,25}$/));function b(e){var r=e.indexOf("@"),t=e.lastIndexOf(".");return!(r<1||t<r+2||t+2>=e.length)}function j(e,r){for(var t=0;t<e.length;t++)if("string"==typeof r){if(e[t]==r)return!0}else if("object"==typeof r&&e[t].match(r))return!0;return!1}return Array.prototype.indexOf||(Array.prototype.indexOf=function(e){for(var r=0;r<this.length;r++)if(this[r]===e)return r;return-1}),"function"!=typeof window.CustomEvent&&(window.customEvent=function(e,r){r=r||{bubbles:!1,cancelable:!1,detail:void 0};var t=document.createEvent("CustomEvent");return t.initCustomEvent(e,r.bubbles,r.cancelable,r.detail),t}),MSobject.inArray=j,MSobject.log=function(e,r,t){if(t&&"log"!=t){if("warn"==t){if(srv.show_log||!0===r)try{console.warn(e)}catch(e){}}else if("info"==t){if(srv.show_log||!0===r)try{console.info(e)}catch(e){}}else if("error"==t)throw new Error(e)}else if(srv.show_log||!0===r)try{console.log(e)}catch(e){}},MSobject.validateAll=function(r,t){var a=!0;if(r){var s=[];for(var o in r)"string"==typeof r[o]&&jQuery("#"+r[o]).hasClass("req")&&s.push(jQuery("#"+r[o])[0])}else s=jQuery(".req").toArray();for(var n=0;n<s.length;n++){var i=s[n];if(-1!=navigator.userAgent.indexOf("MSIE 8.0")?(setTimeout(function(){"object"==typeof i&&i.focus()},0),setTimeout(function(){"object"==typeof i&&i.blur()},0)):(i.focus(),i.blur()),""==i.value||null==i.value||-1!=i.className.indexOf("numeric")&&0==i.value||-1!=i.className.indexOf("phone")&&!i.value.match(g)){var l=__MS.validateField(i);t&&t(i,l),a=!1}"checkbox"==i.type&&(__MS.unsetError(i),i.checked||(__MS.setError(i),a=!1))}if(0!=this.errors.length)if(r)for(e in this.errors)"function"!=typeof this.errors[e]&&-1<r.indexOf(this.errors[e])&&(a=!1);else a=!1;return a},MSobject.validateEmail=b,MSobject.validateField=function(e,r,t){if($field=jQuery(e),$field[0]){var a,s=!0,o=!1,n=!1,i=!0,l=!0,d=!0,c=!1,u=e.className.split(" "),v=$field.hasClass("email"),p=$field.hasClass("numeric"),f=$field.hasClass("phone"),y=$field.hasClass("req");if(j(u,h)||j(u,_))for(var m=0;m<u.length;m++)-1<u[m].search(h)&&(n=u[m].replace("len","")),-1<u[m].search(_)&&(o=u[m].replace("max_len",""));return jQuery.trim(e.value).length<n?(s=!1,a="too_short"):!1!==o&&jQuery.trim(e.value).length>o&&e.value!==r&&(s=!1,a="too_long"),f&&$field.val()!=r&&""!==jQuery.trim($field.val())&&(e.value.match(g)||(d=!1)),p&&$field.val()!==r&&""!==jQuery.trim($field.val())&&((parseInt($field.val())||parseFloat($field.val()))&&isFinite($field.val())&&0!=parseFloat($field.val())||(l=!1)),v&&""!==jQuery.trim($field.val())&&(i=b($field.val())),!1===l||!1===i||!1===d||!1===s||(""===jQuery.trim($field.val())||null===$field.val()||$field.val()===r)&&y?(null!==r&&""===jQuery.trim($field.val())&&void 0!==r&&$field.val(r),i?d?l?a||(a="required"):a="invalid_number":a="invalid_phone":a="invalid_email",__MS.setError($field),c=!1):(__MS.unsetError($field),c=!0),return_obj={state:c,code:a}}},MSobject.setError=function(e){var r=e.attr("id");jQuery("#"+r+"_error_style"),j(this.errors,r)||this.errors.push(r),e.addClass("error"),e.parent().addClass("error")},MSobject.unsetError=function(e){e instanceof jQuery==0&&(e=jQuery(e));var t=e.attr("id"),a=this.errors;e.removeClass("error"),e.parent().removeClass("error"),jQuery("#"+t+"_error").remove(),jQuery(a).each(function(e,r){r==t&&delete a[e]}),this.errors=function(e){var r=[];for(var t in e)"function"!=typeof e[t]&&void 0!==e[t]&&r.push(e[t]);return r}(a)},MSobject.getCookie=function(e){var r,t,a,s=document.cookie.split(";");for(r=0;r<s.length;r++)if(t=s[r].substr(0,s[r].indexOf("=")),a=s[r].substr(s[r].indexOf("=")+1),(t=t.replace(/^\s+|\s+$/g,""))==e)return unescape(a)},MSobject.setCookie=function(e,r,t,a,s){var o=new Date;-1==t?(o.setMonth(o.getMonth()-1),cexp="expires="+o+";"):1==t?(o.setMonth(o.getMonth()+1),cexp="expires="+o+";"):cexp="",cpath=a?"path="+a+";":"path="+document.location.pathname+";",cdomain=s?"domain="+s+";":"";var n=e+"="+r+";"+cexp+cpath+cdomain;document.cookie=n},MSobject.isDOM=function(e){return"HTMLElement"in window?e&&e instanceof HTMLElement:!(!e||"object"!=typeof e||1!==e.nodeType||!e.nodeName)},MSobject.hammerTime=function(){var e=window.MutationObserver||window.WebKitMutationObserver,r="ontouchstart"in window||window.DocumentTouch&&document instanceof DocumentTouch;if(void 0===document.documentElement.style["touch-action"]&&!document.documentElement.style["-ms-touch-action"]&&r&&e){window.Hammer=window.Hammer||{};var t=/touch-action[:][\s]*(none)[^;'"]*/,a=/touch-action[:][\s]*(manipulation)[^;'"]*/,s=/touch-action/,o=!!navigator.userAgent.match(/(iPad|iPhone|iPod)/g),n=function(){try{var e=document.createElement("canvas");return!(!window.WebGLRenderingContext||!e.getContext("webgl")&&!e.getContext("experimental-webgl"))}catch(e){return!1}}()&&o;window.Hammer.time={getTouchAction:function(e){return this.checkStyleString(e.getAttribute("style"))},checkStyleString:function(e){if(s.test(e))return t.test(e)?"none":!a.test(e)||"manipulation"},shouldHammer:function(e){var r=this.hasParent(e.target);return!(!r||n&&!(Date.now()-e.target.lastStart<125))&&r},touchHandler:function(e){var r=e.target.getBoundingClientRect(),t=r.top!==this.pos.top||r.left!==this.pos.left,a=this.shouldHammer(e);("none"===a||!1===t&&"manipulation"===a)&&("touchend"===e.type&&(e.target.focus(),setTimeout(function(){e.target.click()},0)),e.preventDefault()),this.scrolled=!1,delete e.target.lastStart},touchStart:function(e){this.pos=e.target.getBoundingClientRect(),n&&this.hasParent(e.target)&&(e.target.lastStart=Date.now())},styleWatcher:function(e){e.forEach(this.styleUpdater,this)},styleUpdater:function(e){if(e.target.updateNext)e.target.updateNext=!1;else{var r=this.getTouchAction(e.target);r?"none"!==r&&(e.target.hadTouchNone=!1):!r&&(e.oldValue&&this.checkStyleString(e.oldValue)||e.target.hadTouchNone)&&(e.target.hadTouchNone=!0,e.target.updateNext=!1,e.target.setAttribute("style",e.target.getAttribute("style")+" touch-action: none;"))}},hasParent:function(e){for(var r,t=e;t&&t.parentNode;t=t.parentNode)if(r=this.getTouchAction(t))return r;return!1},installStartEvents:function(){document.addEventListener("touchstart",this.touchStart.bind(this)),document.addEventListener("mousedown",this.touchStart.bind(this))},installEndEvents:function(){document.addEventListener("touchend",this.touchHandler.bind(this),!0),document.addEventListener("mouseup",this.touchHandler.bind(this),!0)},installObserver:function(){this.observer=new e(this.styleWatcher.bind(this)).observe(document,{subtree:!0,attributes:!0,attributeOldValue:!0,attributeFilter:["style"]})},install:function(){this.installEndEvents(),this.installStartEvents(),this.installObserver()}},window.Hammer.time.install()}},MSobject.extend=function(e){e=e||{};for(var r=1;r<arguments.length;r++)if(arguments[r])for(var t in arguments[r])arguments[r].hasOwnProperty(t)&&(e[t]=arguments[r][t]);return e},MSobject.errors=[],MSobject}();